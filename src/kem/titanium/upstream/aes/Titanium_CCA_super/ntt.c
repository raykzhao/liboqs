/* ****************************** *
 * Titanium_CCA_super             *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 1280=5*256 */
#define N1_1280 5
#define N2_1280 256

/* 3072=3*1024 */
#define N1_3072 3
#define N2_3072 1024

/* 3328=13*256 */
#define N1_3328 13
#define N2_3328 256

/* multiplication inverses of 1280, 3072, 3328 (in Montgomery form) */
#define INV_1280 292045
#define INV_3072 820566
#define INV_3328 112325

/* omega_n: n-th root of unity mod Q */

static const uint32_t w_3[2]={17202,1180878};

/* (in Montgomery form) */
static const uint32_t w_5[4][4]={{640502,10316,492719,38216},
{10316,38216,640502,492719},
{492719,640502,38216,10316},
{38216,492719,10316,640502}};

static const uint32_t w_13[12][12]={{273633,237649,176418,1194162,446707,1073462,821584,920707,18182,1072068,337569,600017},
{237649,1194162,1073462,920707,1072068,600017,273633,176418,446707,821584,18182,337569},
{176418,1073462,18182,600017,237649,446707,920707,337569,273633,1194162,821584,1072068},
{1194162,920707,600017,176418,821584,337569,237649,1073462,1072068,273633,446707,18182},
{446707,1072068,237649,821584,600017,1194162,18182,273633,1073462,337569,176418,920707},
{1073462,600017,446707,337569,1194162,1072068,176418,18182,237649,920707,273633,821584},
{821584,273633,920707,237649,18182,176418,1072068,1194162,337569,446707,600017,1073462},
{920707,176418,337569,1073462,273633,18182,1194162,600017,821584,237649,1072068,446707},
{18182,446707,273633,1072068,1073462,237649,337569,821584,176418,600017,920707,1194162},
{1072068,821584,1194162,273633,337569,920707,446707,237649,600017,18182,1073462,176418},
{337569,18182,821584,446707,176418,273633,600017,1072068,920707,1073462,1194162,237649},
{600017,337569,1072068,18182,920707,821584,1073462,446707,1194162,176418,237649,273633}};

/* omega_256,1024,1280,3072,3328 respectively (in Montgomery form) */
static const uint32_t omega_256[128]={16328,688000,156521,487395,599876,822381,1049396,927573,350174,856443,815192,677799,706991,39238,924278,793646,517192,265207,798884,99825,1045215,1049601,258218,329466,34369,136806,455596,224439,1042265,395819,965312,1055146,211861,616763,152708,956588,26580,58672,967717,507841,699458,410972,580649,599822,764927,312625,1196718,768487,727957,603334,197348,928015,864819,408538,608992,892446,116858,220267,375148,226978,992518,4924,491003,800038,218304,239017,489557,992109,989711,257636,242720,613302,641429,704237,703327,489468,143069,285697,900907,776855,756525,336629,23316,313260,496760,3027,957574,898154,1087021,46932,1078829,28128,906966,922388,1178918,1087989,100634,1062867,395139,818671,1006950,805572,470857,1152765,862402,410595,1022629,1158047,447476,1080961,255322,931219,280153,593341,214775,832882,951235,410338,926684,1090499,730006,254112,265051,899146,1033138,624664,128139,818877};
static const uint32_t omega_1024[512]={16328,361075,173386,295315,688000,562640,415542,617614,156521,608209,561889,880647,487395,59363,430400,742050,599876,815448,351464,377698,822381,1127667,764634,1076402,1049396,1049322,977098,1173253,927573,760093,238629,474190,350174,316739,32366,439110,856443,825911,978704,344547,815192,101608,926766,1170542,677799,191112,822757,296562,706991,1126641,961339,169441,39238,1155777,644131,877412,924278,1138416,472929,317519,793646,638170,1049881,324601,517192,387291,600501,227367,265207,56536,67410,1095786,798884,958134,635604,941627,99825,384639,408311,748644,1045215,562909,678086,471224,1049601,51321,967975,655772,258218,423758,249863,655845,329466,473108,492223,1177248,34369,1195957,323138,287385,136806,535665,445724,123221,455596,173645,548099,600498,224439,1001722,46576,1129179,1042265,79871,78831,261872,395819,537262,806315,1022304,965312,452846,1083888,1167246,1055146,670917,662766,1093957,211861,706404,553729,104973,616763,524026,1066870,132731,152708,480964,971193,202297,956588,324789,700680,957510,26580,782379,424307,785687,58672,954065,258503,701918,967717,403964,100215,765279,507841,845363,794560,332153,699458,962919,513440,319582,410972,949618,710555,1010862,580649,21111,236959,42351,599822,762744,429843,198418,764927,164289,1001291,824001,312625,809426,464397,376854,1196718,1065874,358716,267164,768487,44606,404540,662391,727957,23999,659485,287863,603334,596213,834603,1075529,197348,918688,474900,1043134,928015,1191485,750790,743549,864819,614320,535820,597004,408538,970196,427306,118468,608992,128016,343192,690793,892446,22409,305726,66407,116858,235713,24336,988397,220267,524093,1132262,457030,375148,729743,569054,685201,226978,1083624,909582,1172092,992518,648120,1176433,437010,4924,13500,1195190,772627,491003,1184609,30219,739800,800038,886357,69950,1178664,218304,1004367,231934,1128356,239017,852878,940714,406818,489557,971394,398473,731404,992109,248936,949174,277211,989711,304650,214312,702418,257636,1053807,562134,1119767,242720,872763,1179178,719968,613302,740333,122165,623021,641429,636422,541914,554343,704237,834899,166344,610809,703327,1144820,732828,1183852,489468,884530,682960,435924,143069,657948,1183913,549004,285697,885480,412079,831969,900907,1091859,560375,601064,776855,1023288,727615,888288,756525,350504,638819,485224,336629,275710,722816,996788,23316,1190958,236438,731936,313260,231105,319252,88892,496760,813036,393514,683744,3027,558190,864666,464992,957574,89044,645112,636787,898154,801093,717956,1045752,1087021,630811,1055983,289748,46932,278554,1102398,63710,1078829,1021986,654944,648171,28128,1095146,174244,1132723,906966,1015038,1062182,349567,922388,491857,820032,33124,1178918,466208,946309,1075214,1087989,377498,627181,1107346,100634,1174223,676212,1038362,1062867,1018127,482803,369895,395139,1071663,18375,1160866,818671,1100950,1046624,740012,1006950,356780,773790,428010,805572,297136,69134,382248,470857,691409,295581,947616,1152765,100581,1122495,509086,862402,651490,871310,959131,410595,581666,1013703,957303,1022629,84431,935148,964807,1158047,463489,688727,74111,447476,635092,441915,1197961,1080961,706656,799681,537925,255322,1191505,770310,625773,931219,724346,93906,598100,280153,266860,471783,397104,593341,427693,496180,246956,214775,1154306,406516,194805,832882,593914,986941,1195373,951235,1090666,594088,1156765,410338,330834,610195,104063,926684,1090510,441832,1116953,1090499,431096,223265,1053979,730006,825742,813760,1100138,254112,10545,707272,202816,265051,1102361,27598,577866,899146,571204,387439,744949,1033138,756567,391496,1110338,624664,1046916,1025004,6269,128139,463240,445703,102725,818877,103925,791996,225851};
static const uint32_t omega_1280[1280]={16328,87354,457067,493635,602982,688000,1088544,768941,183639,177820,156521,158653,589769,630372,607070,487395,714589,452276,1098302,622444,599876,624129,1129419,645542,1094144,822381,180146,384103,687353,1013908,1049396,463819,968839,311231,265793,927573,54359,1169127,956008,668019,350174,1082422,299749,430069,817922,856443,744811,809142,88039,121295,815192,830391,941202,663651,548107,677799,785812,207713,31015,809435,706991,790540,1040142,1094358,276729,39238,1161753,577561,753489,1165802,924278,707533,864174,168200,578182,793646,1104013,1053483,400128,326814,517192,553936,528039,1068218,540742,265207,887750,1112031,719227,428074,798884,400919,1053211,500225,494715,99825,267998,948615,494776,134638,1045215,218535,373904,110793,988820,1049601,1150393,811463,1000191,507726,258218,512977,171404,403372,665849,329466,439807,1013543,703604,860911,34369,464902,54940,695439,954148,136806,141670,325010,705362,980380,455596,616521,440661,302844,801913,224439,738323,131072,463491,349553,1042265,361538,300864,1125327,195722,395819,833388,353646,157090,129852,965312,380266,68812,382816,777764,1055146,347536,441092,1196960,126226,211861,2137,944627,182872,957811,616763,853741,479410,124926,884073,152708,1046500,401952,994607,659824,956588,331245,80244,1073835,662806,26580,595958,312893,350115,773781,58672,114897,993753,172442,858279,967717,574371,209584,254255,372466,507841,88161,190921,1171545,568312,699458,615961,435317,1141850,1140709,410972,53757,923766,120722,193568,580649,885650,1091991,870297,500478,599822,828999,1030611,113402,808332,764927,1035337,21578,137454,79392,312625,1100637,815881,1145044,1136958,1196718,911227,35295,679124,284993,768487,42383,678302,208687,861851,727957,853692,1197791,168387,134965,603334,417512,800785,110982,271775,197348,616721,613724,3199,509760,928015,640502,1046048,1184949,833148,864819,516664,959668,360637,258035,408538,235915,197450,1028465,401001,608992,916507,770299,1155063,256,892446,335303,392816,1044347,449868,116858,875543,1098234,347948,342331,220267,458894,750686,351743,720855,375148,1115360,203301,262759,590542,226978,557167,250794,989825,32265,992518,331811,462185,645168,782497,4924,355067,889499,67564,1123986,491003,338249,797469,45107,327757,800038,548855,103012,24564,1055952,218304,850932,486835,709245,93201,239017,808977,1113391,218742,786650,489557,632528,148412,971273,129073,992109,19830,1045007,1140784,925151,989711,65408,384563,7125,923765,257636,1123579,1103275,259130,247833,242720,604698,567452,1033560,107313,613302,273019,3834,1029283,1024963,641429,1123356,484991,383570,579574,704237,456181,793258,313000,77289,703327,447497,60001,264503,230645,489468,837064,251802,759828,678600,143069,475284,735939,656016,1159865,285697,227511,664946,560465,384959,900907,450276,565753,24651,1125244,776855,909548,1080430,1068050,778755,756525,30924,89718,274241,426266,336629,953164,675110,1136691,612245,23316,599041,1129624,134035,936768,313260,422079,912829,1145971,16185,496760,461649,948131,866697,979587,3027,97348,347053,676099,1111898,957574,717194,819444,939429,201730,898154,1177084,586939,1116829,354243,1087021,822869,458650,611434,837118,46932,858636,12659,428881,532738,1078829,1018541,511683,22132,964282,28128,713423,749227,29742,181131,906966,1158483,204047,1159881,491235,922388,689497,1000137,712596,159410,1178918,1083673,345918,322959,1165022,1087989,79027,1164914,299648,1079492,100634,926105,964584,612935,201055,1062867,1140065,1123675,1138422,834149,395139,484590,174358,910794,613088,818671,144742,251633,1134755,901848,1006950,24532,644876,26631,801830,805572,53971,378114,1177895,971218,470857,625231,10316,132675,239172,1152765,731406,681220,852689,743218,862402,767446,1196299,770305,333579,410595,152852,500180,665440,17485,1022629,311078,846258,647617,942791,1158047,1192582,495218,720781,922136,447476,539033,625438,423062,511439,1080961,251576,552286,1196911,844607,255322,451110,197172,751965,158563,931219,465692,918251,410402,219472,280153,893454,105306,1039151,194898,593341,390612,886391,277521,628721,214775,1193795,951795,11659,761647,832882,143432,1094904,1000788,239576,951235,6315,402572,1171678,329965,410338,595401,1094888,795250,742780,926684,764724,74935,715094,799404,1090499,274134,699092,407083,564339,730006,667860,554042,392127,729694,254112,781872,512423,542657,454636,265051,680876,27865,779375,933596,899146,741549,538397,242829,58044,1033138,377133,107376,374287,388295,624664,963370,293272,642107,547901,128139,675118,41379,360643,634632,818877,694402,362327,103008,572220,1181753,1110727,741014,704446,595099,510081,109537,429140,1014442,1020261,1041560,1039428,608312,567709,591011,710686,483492,745805,99779,575637,598205,573952,68662,552539,103937,375700,1017935,813978,510728,184173,148685,734262,229242,886850,932288,270508,1143722,28954,242073,530062,847907,115659,898332,768012,380159,341638,453270,388939,1110042,1076786,382889,367690,256879,534430,649974,520282,412269,990368,1167066,388646,491090,407541,157939,103723,921352,1158843,36328,620520,444592,32279,273803,490548,333907,1029881,619899,404435,94068,144598,797953,871267,680889,644145,670042,129863,657339,932874,310331,86050,478854,770007,399197,797162,144870,697856,703366,1098256,930083,249466,703305,1063443,152866,979546,824177,1087288,209261,148480,47688,386618,197890,690355,939863,685104,1026677,794709,532232,868615,758274,184538,494477,337170,1163712,733179,1143141,502642,243933,1061275,1056411,873071,492719,217701,742485,581560,757420,895237,396168,973642,459758,1067009,734590,848528,155816,836543,897217,72754,1002359,802262,364693,844435,1040991,1068229,232769,817815,1129269,815265,420317,142935,850545,756989,1121,1071855,986220,1195944,253454,1015209,240270,581318,344340,718671,1073155,314008,1045373,151581,796129,203474,538257,241493,866836,1117837,124246,535275,1171501,602123,885188,847966,424300,1139409,1083184,204328,1025639,339802,230364,623710,988497,943826,825615,690240,1109920,1007160,26536,629769,498623,582120,762764,56231,57372,787109,1144324,274315,1077359,1004513,617432,312431,106090,327784,697603,598259,369082,167470,1084679,389749,433154,162744,1176503,1060627,1118689,885456,97444,382200,53037,61123,1363,286854,1162786,518957,913088,429594,1155698,519779,989394,336230,470124,344389,290,1029694,1063116,594747,780569,397296,1087099,926306,1000733,581360,584357,1194882,688321,270066,557579,152033,13132,364933,333262,681417,238413,837444,940046,789543,962166,1000631,169616,797080,589089,281574,427782,43018,1197825,305635,862778,805265,153734,748213,1081223,322538,99847,850133,855750,977814,739187,447395,846338,477226,822933,82721,994780,935322,607539,971103,640914,947287,208256,1165816,205563,866270,735896,552913,415584,1193157,843014,308582,1130517,74095,707078,859832,400612,1152974,870324,398043,649226,1095069,1173517,142129,979777,347149,711246,488836,1104880,959064,389104,84690,979339,411431,708524,565553,1049669,226808,1069008,205972,1178251,153074,57297,272930,208370,1132673,813518,1190956,274316,940445,74502,94806,938951,950248,955361,593383,630629,164521,1090768,584779,925062,1194247,168798,173118,556652,74725,713090,814511,618507,493844,741900,404823,885081,1120792,494754,750584,1138080,933578,967436,708613,361017,946279,438253,519481,1055012,722797,462142,542065,38216,912384,970570,533135,637616,813122,297174,747805,632328,1173430,72837,421226,288533,117651,130031,419326,441556,1167157,1108363,923840,771815,861452,244917,522971,61390,585836,1174765,599040,68457,1064046,261313,884821,776002,285252,52110,1181896,701321,736432,249950,331384,218494,1195054,1100733,851028,521982,86183,240507,480887,378637,258652,996351,299927,20997,611142,81252,843838,111060,375212,739431,586647,360963,1151149,339445,1185422,769200,665343,119252,179540,686398,1175949,233799,1169953,484658,448854,1168339,1016950,291115,39598,994034,38200,706846,275693,508584,197944,485485,1038671,19163,114408,852163,875122,33059,110092,1119054,33167,898433,118589,1097447,271976,233497,585146,997026,135214,58016,74406,59659,363932,802942,713491,1023723,287287,584993,379410,1053339,946448,63326,296233,191131,1173549,553205,1171450,396251,392509,1144110,819967,20186,226863,727224,572850,1187765,1065406,958909,45316,466675,516861,345392,454863,335679,430635,1782,427776,864502,787486,1045229,697901,532641,1180596,175452,887003,351823,550464,255290,40034,5499,702863,477300,275945,750605,659048,572643,775019,686642,117120,946505,645795,1170,353474,942759,746971,1000909,446116,1039518,266862,732389,279830,787679,978609,917928,304627,1092775,158930,1003183,604740,807469,311690,920560,569360,983306,4286,246286,1186422,436434,365199,1054649,103177,197293,958505,246846,1191766,795509,26403,868116,787743,602680,103193,402831,455301,271397,433357,1123146,482987,398677,107582,923947,498989,790998,633742,468075,530221,644039,805954,468387,943969,416209,685658,655424,743445,933030,517205,1170216,418706,264485,298935,456532,659684,955252,1140037,164943,820948,1090705,823794,809786,573417,234711,904809,555974,650180,1069942,522963,1156702,837438,563449,379204,503679,835754,1095073,625861};
static const uint32_t omega_3072[3072]={16328,1109427,524498,361075,933609,329461,173386,660824,468228,295315,396646,521667,688000,146333,1160648,562640,249369,605903,415542,173701,707395,617614,602755,322864,156521,31109,19961,608209,410359,312640,561889,351330,824066,880647,246914,376065,487395,173783,426654,59363,682787,680197,430400,267076,135398,742050,682599,359538,599876,83588,1069436,815448,112380,240985,351464,657509,377484,377698,755449,613517,822381,498409,950173,1127667,26298,54154,764634,507147,138740,1076402,168019,27087,1049396,1047528,79130,1049322,424235,553696,977098,715415,72765,1173253,961898,331861,927573,715025,414466,760093,581258,765519,238629,615495,742081,474190,484539,630132,350174,866150,393279,316739,715295,454384,32366,844778,188814,439110,223600,976071,856443,182858,170901,825911,1153420,266117,978704,739861,944696,344547,859574,699007,815192,287524,522743,101608,272470,1012743,926766,1154819,20343,1170542,907204,685472,677799,49245,491474,191112,139880,446224,822757,1139727,611221,296562,554384,1105439,706991,744253,635564,1126641,353842,902587,961339,302464,335377,169441,476938,251839,39238,636060,188259,1155777,188602,434391,644131,769159,1043023,877412,700478,819679,924278,760358,886677,1138416,497269,382270,472929,111739,492329,317519,31893,82623,793646,1175543,368621,638170,766451,349796,1049881,453632,1145892,324601,652943,581019,517192,1091357,382231,387291,70423,454265,600501,442231,72670,227367,308296,239141,265207,178565,973902,56536,557695,450119,67410,381546,818498,1095786,983786,932102,798884,512255,388073,958134,361103,165652,635604,200714,1133498,941627,609661,465285,99825,780960,45461,384639,237444,40939,408311,515711,419791,748644,139916,1170395,1045215,1174863,534327,562909,102771,337917,678086,863773,334717,471224,791505,805760,1049601,944716,480624,51321,718527,639353,967975,404967,1006408,655772,1079143,1025869,258218,130369,850509,423758,243558,1024732,249863,492570,938878,655845,317839,1011044,329466,1105966,758281,473108,1149916,866279,492223,914200,841199,1177248,886936,324739,34369,635054,651880,1195957,404827,53869,323138,942503,1058661,287385,954801,507314,136806,976839,331011,535665,920469,782947,445724,1015075,978675,123221,1098294,316243,455596,850530,746351,173645,1045228,5328,548099,575597,407804,600498,1080764,253812,224439,514384,915826,1001722,42845,77750,46576,1081966,404897,1129179,489455,1010823,1042265,871842,542585,79871,280282,11158,78831,392764,107479,261872,1149825,666457,395819,825384,1102130,537262,464352,1000223,806315,332934,979714,1022304,263633,132226,965312,916474,857909,452846,710198,1058646,1083888,662430,492674,1167246,766021,419343,1055146,33952,733147,670917,788965,297115,662766,861838,48638,1093957,101026,745529,211861,358734,401137,706404,284732,935306,553729,1141721,1119015,104973,104366,706849,616763,24331,988049,524026,983517,1078700,1066870,249711,896082,132731,507493,1174983,152708,505715,219891,480964,1166549,157117,971193,374874,1189905,202297,462319,406791,956588,744888,463205,324789,973602,411543,700680,157319,308833,957510,188976,702677,26580,1134183,510420,782379,1133845,966305,424307,803957,223933,785687,1117058,507866,58672,1192979,869763,954065,1010853,647340,258503,571865,415153,701918,1032575,237950,967717,207079,1009567,403964,831496,514810,100215,439259,458621,765279,1001867,729883,507841,188096,705694,845363,275303,1058850,794560,325584,691778,332153,278519,655725,699458,1068238,212346,962919,269818,1179764,513440,962629,93823,319582,230400,517092,410972,829253,289691,949618,646253,1189381,710555,552322,1093448,1010862,1127903,913158,580649,994970,1068025,21111,645110,61930,236959,634835,539630,42351,191083,721321,599822,794453,735749,762744,227721,440505,429843,610711,1019882,198418,607679,997602,764927,44609,817780,164289,407468,231334,1001291,1123957,542756,824001,737917,178054,312625,160311,58959,809426,713006,36096,464397,1006876,485347,376854,284556,456677,1196718,969945,30620,1065874,182330,1131176,358716,638092,595175,267164,973753,1019596,768487,304695,718466,44606,258232,345431,404540,437422,479895,662391,407036,1125930,727957,702325,267403,23999,166868,1001751,659485,1122233,74880,287863,253374,1198020,603334,488338,1138545,596213,979731,598833,834603,148818,995561,1075529,278567,23845,197348,1115086,509181,918688,466388,955122,474900,1121989,92054,1043134,15230,1186710,928015,487508,882714,1191485,169651,108625,750790,244198,586872,743549,1117210,104354,864819,143250,12619,614320,834604,335334,535820,1076505,209871,597004,1149924,1160326,408538,922008,291631,970196,120977,686659,427306,661614,451905,118468,1167686,165472,608992,286505,957818,128016,476007,327188,343192,925485,645942,690793,1118367,248786,892446,74401,802774,22409,730516,1160531,305726,125421,491711,66407,206634,677536,116858,397176,1132505,235713,663613,694198,24336,722548,621483,988397,735220,338422,220267,1122282,827597,524093,301198,228078,1132262,439403,959143,457030,1142411,422307,375148,777806,31768,729743,753383,1053543,569054,878155,304470,685201,451365,38632,226978,836513,564321,1083624,543527,858117,909582,930550,63573,1172092,71402,945117,992518,199654,1109903,648120,773182,200104,1176433,1032683,14301,437010,312487,778885,4924,674738,608406,13500,797819,754161,1195190,1116775,439402,772627,916771,1141435,491003,1000070,1023311,1184609,830386,750063,30219,553980,33997,739800,349949,832885,800038,97139,596842,886357,159265,250426,69950,890191,7252,1178664,217691,1087547,218304,406079,1144187,1004367,966374,115020,231934,291277,837987,1128356,341155,784070,239017,1098843,876642,852878,188273,172758,940714,448055,880468,406818,2115,312691,489557,866159,873842,971394,724079,1034201,398473,1031395,595974,731404,253480,601339,992109,591794,1045255,248936,115902,601949,949174,500738,442534,277211,1101321,604024,989711,210639,71572,304650,711813,365574,214312,1040589,970167,702418,840257,399002,257636,603428,49627,1053807,687957,512712,562134,520672,807135,1119767,189528,624543,242720,474854,928820,872763,998238,779084,1179178,240435,802630,719968,1038765,1019987,613302,258114,1100082,740333,322254,199456,122165,622682,579934,623021,310565,521352,641429,1195028,853208,636422,614515,64713,541914,726140,859676,554343,646769,387076,704237,1055938,390661,834899,245828,295378,166344,311928,749488,610809,129154,670878,703327,255799,624702,1144820,458976,1084004,732828,1076363,82381,1183852,1011332,132429,489468,1039369,1056037,884530,847618,342452,682960,599278,1166634,435924,231800,457834,143069,997572,1159852,657948,788500,1027088,1183913,407998,842172,549004,443156,76306,285697,13015,193634,885480,721830,888067,412079,34452,540829,831969,78884,693464,900907,313600,1103180,1091859,562945,826942,560375,713222,786879,601064,19611,23983,776855,1169121,643869,1023288,488984,621700,727615,412146,550214,888288,897361,268576,756525,27125,948518,350504,116218,835036,638819,809154,300056,485224,198925,522892,336629,61678,1158167,275710,293678,580609,722816,288369,1180152,996788,1097190,472511,23316,971107,1107632,1190958,118361,379770,236438,504560,448491,731936,39269,427651,313260,1186033,455188,231105,221962,973518,319252,980332,75335,88892,735394,444019,496760,94025,855303,813036,714244,911352,393514,1017083,503450,683744,661940,153990,3027,287781,534115,558190,523302,131005,864666,360246,864294,464992,562363,101920,957574,145190,33197,89044,331882,52085,645112,434962,515558,636787,402238,1188669,898154,811801,398536,801093,386235,792892,717956,767926,1100347,1045752,695151,458096,1087021,353530,217483,630811,1196033,203071,1055983,397314,513931,289748,798301,798798,46932,389126,874198,278554,1193380,183576,1102398,204148,656107,63710,367002,585178,1078829,1165814,847172,1021986,855595,163982,654944,1196344,701659,648171,700850,714933,28128,1123430,491466,1095146,223565,438416,174244,148698,179099,1132723,161447,1078879,906966,623661,1070786,1015038,67988,360504,1062182,461833,814171,349567,270552,303193,922388,480932,1188442,491857,939961,176984,820032,869971,212720,33124,850348,346707,1178918,867596,527190,466208,928510,560691,946309,476524,909480,1075214,231996,1072540,1087989,1188868,874327,377498,592760,309480,627181,1058718,136068,1107346,562946,1013458,100634,714198,718183,1174223,972187,69223,676212,1172441,469112,1038362,135061,186370,1062867,30626,986889,1018127,1137032,1144621,482803,320226,538604,369895,1039516,918026,395139,991090,1026869,1071663,452473,628428,18375,719840,1126337,1160866,488374,664635,818671,1014867,521939,1100950,895286,228039,1046624,398087,921079,740012,354668,412354,1006950,1108640,1100369,356780,165497,479568,773790,982218,806778,428010,179968,276111,805572,728942,1114192,297136,985359,791925,69134,849422,156555,382248,1161901,641393,470857,630750,601286,691409,996447,993527,295581,888581,434823,947616,1042493,266574,1152765,302399,192647,100581,413498,1122836,1122495,1018832,841902,509086,1170883,1010867,862402,1010615,585529,651490,339577,1189748,871310,756796,253559,959131,615000,668898,410595,1419,1088384,581666,186863,763018,1013703,269976,697267,957303,1116837,22584,1022629,977283,476526,84431,155732,233948,935148,1036226,697858,964807,176212,599400,1158047,657329,350872,463489,579769,997987,688727,360312,1193540,74111,626779,360308,447476,714994,622875,635092,551002,498933,441915,1037664,537722,1197961,381619,57194,1080961,1055034,709618,706656,561605,96350,799681,603463,587282,537925,722117,504514,255322,314564,1192454,1191505,305728,498453,770310,68359,69242,625773,823929,487656,931219,242353,314099,724346,514571,1049969,93906,225357,410489,598100,699609,478210,280153,1110295,679451,266860,582696,605383,471783,820902,199875,397104,882244,988878,593341,847986,689723,427693,958446,1046207,496180,940116,333020,246956,1021251,347569,214775,1135665,170421,1154306,184115,995718,406516,1182171,177077,194805,46893,303488,832882,240490,278281,593914,1092445,835950,986941,1132311,1192120,1195373,504854,172469,951235,326213,598404,1090666,892423,576857,594088,1198042,1112443,1156765,1160017,282982,410338,1188128,631802,330834,1068601,825118,610195,624106,204736,104063,502308,940890,926684,237479,578594,1090510,549871,411593,441832,1131889,357633,1116953,92982,408237,1090499,894357,676420,431096,689464,43289,223265,793423,317229,1053979,420522,510606,730006,685770,1147841,825742,782322,87081,813760,368675,1125386,1100138,402500,934540,254112,1067513,371399,10545,760299,664962,707272,439685,841091,202816,219562,219331,265051,1034094,808638,1102361,491542,893390,27598,512592,943753,577866,690015,976720,899146,133118,804325,571204,530420,278145,387439,118928,703214,744949,1057952,1034532,1033138,1013411,919030,756567,672311,808692,391496,825229,946094,1110338,313072,865374,624664,47617,1156000,1046916,947114,861779,1025004,662813,43442,6269,1139829,466557,128139,653936,88852,463240,862444,457720,445703,692482,1048588,102725,144748,260714,818877,1098571,463692,103925,1120882,886855,791996,132879,555998,225851,297156,1121436,1181753,88654,673583,837006,264472,868620,1024695,537257,729853,902766,801435,676414,510081,1051748,37433,635441,948712,592178,782539,1024380,490686,580467,595326,875217,1041560,1166972,1178120,589872,787722,885441,636192,846751,374015,317434,951167,822016,710686,1024298,771427,1138718,515294,517884,767681,931005,1062683,456031,515482,838543,598205,1114493,128645,382633,1085701,957096,846617,540572,820597,820383,442632,584564,375700,699672,247908,70414,1171783,1143927,433447,690934,1059341,121679,1030062,1170994,148685,150553,1118951,148759,773846,644385,220983,482666,1125316,24828,236183,866220,270508,483056,783615,437988,616823,432562,959452,582586,456000,723891,713542,567949,847907,331931,804802,881342,482786,743697,1165715,353303,1009267,758971,974481,222010,341638,1015223,1027180,372170,44661,931964,219377,458220,253385,853534,338507,499074,382889,910557,675338,1096473,925611,185338,271315,43262,1177738,27539,290877,512609,520282,1148836,706607,1006969,1058201,751857,375324,58354,586860,901519,643697,92642,491090,453828,562517,71440,844239,295494,236742,895617,862704,1028640,721143,946242,1158843,562021,1009822,42304,1009479,763690,553950,428922,155058,320669,497603,378402,273803,437723,311404,59665,700812,815811,725152,1086342,705752,880562,1166188,1115458,404435,22538,829460,559911,431630,848285,148200,744449,52189,873480,545138,617062,680889,106724,815850,810790,1127658,743816,597580,755850,1125411,970714,889785,958940,932874,1019516,224179,1141545,640386,747962,1130671,816535,379583,102295,214295,265979,399197,685826,810008,239947,836978,1032429,562477,997367,64583,256454,588420,732796,1098256,417121,1152620,813442,960637,1157142,789770,682370,778290,449437,1058165,27686,152866,23218,663754,635172,1095310,860164,519995,334308,863364,726857,406576,392321,148480,253365,717457,1146760,479554,558728,230106,793114,191673,542309,118938,172212,939863,1067712,347572,774323,954523,173349,948218,705511,259203,542236,880242,187037,868615,92115,439800,724973,48165,331802,705858,283881,356882,20833,311145,873342,1163712,563027,546201,2124,793254,1144212,874943,255578,139420,910696,243280,690767,1061275,221242,867070,662416,277612,415134,752357,183006,219406,1074860,99787,881838,742485,347551,451730,1024436,152853,1192753,649982,622484,790277,597583,117317,944269,973642,683697,282255,196359,1155236,1120331,1151505,116115,793184,68902,708626,187258,155816,326239,655496,1118210,917799,1186923,1119250,805317,1090602,936209,48256,531624,802262,372697,95951,660819,733729,197858,391766,865147,218367,175777,934448,1065855,232769,281607,340172,745235,487883,139435,114193,535651,705407,30835,432060,778738,142935,1164129,464934,527164,409116,900966,535315,336243,1149443,104124,1097055,452552,986220,839347,796944,491677,913349,262775,644352,56360,79066,1093108,1093715,491232,581318,1173750,210032,674055,214564,119381,131211,948370,301999,1065350,690588,23098,1045373,692366,978190,717117,31532,1040964,226888,823207,8176,995784,735762,791290,241493,453193,734876,873292,224479,786538,497401,1040762,889248,240571,1009105,495404,1171501,63898,687661,415702,64236,231776,773774,394124,974148,412394,81023,690215,1139409,5102,328318,244016,187228,550741,939578,626216,782928,496163,165506,960131,230364,991002,188514,794117,366585,683271,1097866,758822,739460,432802,196214,468198,690240,1009985,492387,352718,922778,139231,403521,872497,506303,865928,919562,542356,498623,129843,985735,235162,928263,18317,684641,235452,1104258,878499,967681,680989,787109,368828,908390,248463,551828,8700,487526,645759,104633,187219,70178,284923,617432,203111,130056,1176970,552971,1136151,961122,563246,658451,1155730,1006998,476760,598259,403628,462332,435337,970360,757576,768238,587370,178199,999663,590402,200479,433154,1153472,380301,1033792,790613,966747,196790,74124,655325,374080,460164,1020027,885456,1037770,1139122,388655,485075,1161985,733684,191205,712734,821227,913525,741404,1363,228136,1167461,132207,1015751,66905,839365,559989,602906,930917,224328,178485,429594,893386,479615,1153475,939849,852650,793541,760659,718186,535690,791045,72151,470124,495756,930678,1174082,1031213,196330,538596,75848,1123201,910218,944707,61,594747,709743,59536,601868,218350,599248,363478,1049263,202520,122552,919514,1174236,1000733,82995,688900,279393,731693,242959,723181,76092,1106027,154947,1182851,11371,270066,710573,315367,6596,1028430,1089456,447291,953883,611209,454532,80871,1093727,333262,1054831,1185462,583761,363477,862747,662261,121576,988210,601077,48157,37755,789543,276073,906450,227885,1077104,511422,770775,536467,746176,1079613,30395,1032609,589089,911576,240263,1070065,722074,870893,854889,272596,552139,507288,79714,949295,305635,1123680,395307,1175672,467565,37550,892355,1072660,706370,1131674,991447,520545,1081223,800905,65576,962368,534468,503883,1173745,475533,576598,209684,462861,859659,977814,75799,370484,673988,896883,970003,65819,758678,238938,741051,55670,775774,822933,420275,1166313,468338,444698,144538,629027,319926,893611,512880,746716,1159449,971103,361568,633760,114457,654554,339964,288499,267531,1134508,25989,1126679,252964,205563,998427,88178,549961,424899,997977,21648,165398,1183780,761071,885594,419196,1193157,523343,589675,1184581,400262,443920,2891,81306,758679,425454,281310,56646,707078,198011,174770,13472,367695,448018,1167862,644101,1164084,458281,848132,365196,398043,1100942,601239,311724,1038816,947655,1128131,307890,1190829,19417,980390,110534,979777,792002,53894,193714,231707,1083061,966147,906804,360094,69725,856926,414011,959064,99238,321439,345203,1009808,1025323,257367,750026,317613,791263,1195966,885390,708524,331922,324239,226687,474002,163880,799608,166686,602107,466677,944601,596742,205972,606287,152826,949145,1082179,596132,248907,697343,755547,920870,96760,594057,208370,987442,1126509,893431,486268,832507,983769,157492,227914,495663,357824,799079,940445,594653,1148454,144274,510124,685369,635947,677409,390946,78314,1008553,573538,955361,723227,269261,325318,199843,418997,18903,957646,395451,478113,159316,178094,584779,939967,97999,457748,875827,998625,1075916,575399,618147,575060,887516,676729,556652,3053,344873,561659,583566,1133368,656167,471941,338405,643738,551312,811005,493844,142143,807420,363182,952253,902703,1031737,886153,448593,587272,1068927,527203,494754,942282,573379,53261,739105,114077,465253,121718,1115700,14229,186749,1065652,708613,158712,142044,313551,350463,855629,515121,598803,31447,762157,966281,740247,1055012,200509,38229,540133,409581,170993,14168,790083,355909,649077,754925,1121775,912384,1185066,1004447,312601,476251,310014,786002,1163629,657252,366112,1119197,504617,297174,884481,94901,106222,635136,371139,637706,484859,411202,597017,1178470,1174098,421226,28960,554212,174793,709097,576381,470466,785935,647867,309793,300720,929505,441556,1170956,249563,847577,1081863,363045,559262,388927,898025,712857,999156,675189,861452,1136403,39914,922371,904403,617472,475265,909712,17929,201293,100891,725570,1174765,226974,90449,7123,1079720,818311,961643,693521,749590,466145,1158812,770430,884821,12048,742893,966976,976119,224563,878829,217749,1122746,1109189,462687,754062,701321,1104056,342778,385045,483837,286729,804567,180998,694631,514337,536141,1044091,1195054,910300,663966,639891,674779,1067076,333415,837835,333787,733089,635718,1096161,240507,1052891,1164884,1109037,866199,1145996,552969,763119,682523,561294,795843,9412,299927,386280,799545,396988,811846,405189,480125,430155,97734,152329,502930,739985,111060,844551,980598,567270,2048,995010,142098,800767,684150,908333,399780,399283,1151149,808955,323883,919527,4701,1014505,95683,993933,541974,1134371,831079,612903,119252,32267,350909,176095,342486,1034099,543137,1737,496422,549910,497231,483148,1169953,74651,706615,102935,974516,759665,1023837,1049383,1018982,65358,1036634,119202,291115,574420,127295,183043,1130093,837577,135899,736248,383910,848514,927529,894888,275693,717149,9639,706224,258120,1021097,378049,328110,985361,1164957,347733,851374,19163,330485,670891,731873,269571,637390,251772,721557,288601,122867,966085,125541,110092,9213,323754,820583,605321,888601,570900,139363,1062013,90735,635135,184623,1097447,483883,479898,23858,225894,1128858,521869,25640,728969,159719,1063020,1011711,135214,1167455,211192,179954,61049,53460,715278,877855,659477,828186,158565,280055,802942,206991,171212,126418,745608,569653,1179706,478241,71744,37215,709707,533446,379410,183214,676142,97131,302795,970042,151457,799994,277002,458069,843413,785727,191131,89441,97712,841301,1032584,718513,424291,215863,391303,770071,1018113,921970,392509,469139,83889,900945,212722,406156,1128947,348659,1041526,815833,36180,556688,727224,567331,596795,506672,201634,204554,902500,309500,763258,250465,155588,931507,45316,895682,1005434,1097500,784583,75245,75586,179249,356179,688995,27198,187214,335679,187466,612552,546591,858504,8333,326771,441285,944522,238950,583081,529183,787486,1196662,109697,616415,1011218,435063,184378,928105,500814,240778,81244,1175497,175452,220798,721555,1113650,1042349,964133,262933,161855,500223,233274,1021869,598681,40034,540752,847209,734592,618312,200094,509354,837769,4541,1123970,571302,837773,750605,483087,575206,562989,647079,699148,756166,160417,660359,120,816462,1140887,117120,143047,488463,491425,636476,1101731,398400,594618,610799,660156,475964,693567,942759,883517,5627,6576,892353,699628,427771,1129722,1128839,572308,374152,710425,266862,955728,883982,473735,683510,148112,1104175,972724,787592,599981,498472,719871,917928,87786,518630,931221,615385,592698,726298,377179,998206,800977,315837,209203,604740,350095,508358,770388,239635,151874,701901,257965,865061,951125,176830,850512,983306,62416,1027660,43775,1013966,202363,791565,15910,1021004,1003276,1151188,894593,365199,957591,919800,604167,105636,362131,211140,65770,5961,2708,693227,1025612,246846,871868,599677,107415,305658,621224,603993,39,85638,41316,38064,915099,787743,9953,566279,867247,129480,372963,587886,573975,993345,1094018,695773,257191,271397,960602,619487,107571,648210,786488,756249,66192,840448,81128,1105099,789844,107582,303724,521661,766985,508617,1154792,974816,404658,880852,144102,777559,687475,468075,512311,50240,372339,415759,1111000,384321,829406,72695,97943,795581,263541,943969,130568,826682,1187536,437782,533119,490809,758396,356990,995265,978519,978750,933030,163987,389443,95720,706539,304691,1170483,685489,254328,620215,508066,221361,298935,1064963,393756,626877,667661,919936,810642,1079153,494867,453132,140129,163549,164943,184670,279051,441514,525770,389389,806585,372852,251987,87743,885009,332707,573417,1150464,42081,151165,250967,336302,173077,535268,1154639,1191812,58252,731524,1069942,544145,1109229,734841,335637,740361,752378,505599,149493,1095356,1053333,937367,379204,99510,734389,1094156,77199,311226,406085,1065202,642083,972230,900925,76645};
static const uint32_t omega_3328[3328]={16328,697289,464954,435229,231604,281665,748537,996385,750484,1189082,1039702,950485,326223,688000,100038,906970,918884,323366,1003972,2393,791266,1008968,453779,553151,1076687,45060,156521,1138719,704777,113194,22707,476986,105528,602989,645234,1131114,762513,944002,1083892,487395,28710,79786,670497,197787,485308,190750,96521,670266,723199,450994,36300,445155,599876,993712,668692,792020,108267,21200,1052100,1079751,1078725,67082,786006,815744,652678,822381,343455,1045862,917110,43182,413703,1186500,787235,893690,508491,420095,599506,647573,1049396,674295,894891,178152,816331,868303,147162,352131,730454,681060,569415,1183062,718340,927573,839348,987686,516572,114718,166155,158787,719950,1041381,316091,139965,882221,532704,350174,819827,499273,448644,428295,531739,14066,1003230,564610,136463,222412,774913,1016854,856443,417583,768711,1036842,152997,1099464,943718,708113,663041,845004,793667,376497,1137186,815192,647889,522551,394486,509726,328799,1109709,700524,269465,1024690,273295,819170,1060057,677799,300205,154073,700757,885720,79053,978851,524569,980648,155992,485169,517280,511539,706991,1161189,678336,728099,16009,110674,417568,1191816,598948,812026,95176,270089,196656,39238,240578,1145219,665670,969823,1184193,1164410,877745,988731,992282,269948,579600,236126,924278,331095,1042811,714835,352385,754362,827707,1071179,856767,863163,163341,459939,519776,793646,968844,44902,1018984,679583,298319,636911,1074099,1159916,643417,865750,274773,1062059,517192,597593,693919,874145,697046,130769,290216,364761,306101,378860,378500,948372,23564,265207,123915,729953,435795,1039576,910324,961005,712671,290202,759659,1175353,115361,269,798884,584541,1040816,677993,818452,945306,244394,136516,1123603,564953,46110,491196,641193,99825,924656,451578,336546,640822,979974,1196295,58300,497113,273633,869852,783516,364395,1045215,1195824,164906,644981,1078999,724931,717791,838163,866713,667295,660526,1098830,855741,1049601,882265,489677,356710,963349,489918,747309,890232,1003736,668840,211627,674834,68290,258218,777354,454184,1110126,919015,222492,914515,157406,137144,182741,767156,569730,684424,329466,266855,363938,756923,474440,35690,878291,1162762,637722,961761,953637,75753,611633,34369,999227,857617,848833,616354,1054194,720262,627364,798103,1048750,924802,1125680,684983,136806,132059,1043697,883134,1137495,485796,802706,604677,955058,728360,1040549,1020776,452041,455596,818515,366346,1125084,723221,1028521,39568,516916,1194239,544004,300620,428978,435654,224439,1107212,446624,1096628,667343,504671,343545,903394,1148312,881332,449026,435950,261734,1042265,540804,706945,62549,453670,33471,1169412,1159889,206925,317157,23328,931654,742357,395819,50306,744643,610991,172048,468195,70498,277374,778593,250060,858508,876097,748708,965312,231303,385405,268159,722521,406044,371252,520857,253904,258090,793607,870836,583691,1055146,224980,224197,744820,410676,307257,119755,659135,798094,104532,1141298,1041865,1040875,211861,64801,429799,41246,1108810,898916,462672,107229,546122,462244,199015,591461,1135579,616763,300260,998850,708927,466082,965920,1052662,802470,73043,375419,394226,655060,725843,152708,864720,574039,146642,642799,326461,1163220,897807,594129,160325,468500,1052011,1194012,956588,702566,178659,892354,1052532,875137,271565,495959,476324,807347,286819,337460,19325,26580,256646,789761,329587,448051,381912,552568,748234,1156539,51976,364112,641229,282454,58672,786838,111059,340602,50925,57644,1029690,611853,1017315,1031907,377146,802058,911598,967717,684085,306991,434331,401789,583937,106629,697188,917699,202393,1154695,548201,525860,507841,783430,394035,52192,261805,237649,1095933,1101912,183599,527170,697182,1086941,746084,699458,386102,975257,63642,773525,631497,432429,137858,410320,764301,829288,804909,764868,410972,344552,54808,753315,408411,697819,1090297,731791,108812,223438,588475,297930,826705,580649,599008,317687,648671,30135,619565,337592,1088325,46188,687212,761696,27501,635781,599822,120728,769587,289130,1045538,471530,648552,990606,819721,1093053,868564,1171702,64152,764927,1142921,788982,737382,550167,182624,473132,988016,792910,163738,44489,687665,1162816,312625,860866,258446,336563,161303,437917,1088372,1116621,1020943,533796,698236,110707,684818,1196718,107549,1104530,618695,916062,850174,1129359,1144477,29806,315020,397637,287463,143367,768487,166724,882138,477723,882427,712467,54025,75857,74267,594400,902795,73090,247771,727957,427160,198497,825715,949716,451948,682685,260118,1097699,409671,1099429,732882,485081,603334,498467,419947,1179899,81006,1002306,270096,1197288,802693,971368,735294,740414,90294,197348,887371,234455,134935,191792,656852,498301,309985,1046324,1064367,111810,722603,489232,928015,352664,73095,106736,75201,606844,932620,1050258,321481,260522,484800,142934,1001308,864819,177708,161348,366683,5892,337615,439564,158521,1034526,784035,101934,142062,438111,408538,709773,564580,982673,544705,894890,206359,707266,592750,719186,1026071,856101,479729,608992,248034,498002,357311,784076,143528,1019484,953055,917174,634096,205377,850677,120129,892446,853650,126388,462740,585315,774056,30552,838056,290619,978150,1128380,5186,1082461,116858,905306,1130173,947518,150722,574015,823610,421401,901675,514824,299233,15414,120705,220267,176797,698224,449191,574119,286244,981432,805243,928378,896252,127017,691752,896583,375148,849837,1050470,332002,618763,196067,1078108,697667,585437,927045,157591,909254,1190470,226978,176418,605948,1046391,372579,230679,15358,502216,103032,320882,383381,1049320,421865,992518,801582,1159239,570260,111686,626028,144063,305711,596861,974066,111911,269858,722068,4924,86128,295772,595280,42255,203810,722049,540857,410055,1050670,681007,866305,194941,491003,94739,615738,458491,628758,1014218,929073,461683,448089,508127,1102795,436519,985085,800038,381850,1103321,1174690,845387,773115,215557,44776,978823,116284,322990,827075,926788,218304,435412,1060128,1071264,855334,549040,821807,959220,742764,896380,110764,275100,224937,239017,847349,542707,942669,345231,71551,527428,608262,471767,1151979,481229,231327,906518,489557,147307,1054440,969826,1099572,293524,506323,470740,168543,1091088,1183593,117395,135119,992109,357435,880651,488697,443707,708858,16203,628921,10720,735453,1047825,658495,879359,989711,905285,524439,1053315,354514,605709,599378,663826,267967,147860,1031022,180640,126013,257636,420694,476647,83053,770465,683085,958128,394702,407419,1123300,725107,545683,864307,242720,629875,657105,550416,347567,74454,112015,930573,84018,1106573,499682,892791,706883,613302,880126,920400,692470,1011334,808553,1013526,80940,467806,260292,982005,217685,1122411,641429,631459,306214,785712,722035,935755,81226,787171,302776,716817,755918,68531,648817,704237,968002,1031657,240410,1091671,313965,203997,239664,568635,420983,711391,452732,133855,703327,278590,25149,1084190,468276,181893,725072,334847,641275,183013,283338,283385,155737,489468,261568,932303,407229,492225,370134,906177,523496,96653,541185,742807,881560,8235,143069,787606,13541,236852,813373,438939,1014762,1159518,1087074,588796,828131,1092221,375168,285697,835608,1050738,1159093,1094239,961330,1130044,991978,458309,970108,333684,1097829,337004,900907,612342,402983,451047,937491,235195,827213,628465,892302,123134,1194162,319781,289182,776855,152505,600336,1197383,519190,549814,555047,311779,762368,241693,844520,68883,304601,756525,918097,956817,233568,1192924,495698,649865,1095326,252346,1073680,997839,472260,424819,336629,695803,447721,105574,503548,869900,627661,807191,1092868,96454,163973,604330,1158239,23316,72057,631658,683426,924189,445356,920674,152238,943119,830972,29480,1123935,784877,313260,920636,26023,392892,1142687,200934,375873,767139,1049249,28400,437389,406615,1038189,496760,646056,708499,557868,1011259,527916,22137,979923,238690,486390,820882,692913,496443,3027,879243,667480,234555,908478,315563,656289,803789,8521,462434,830090,946434,775085,957574,446327,1087540,623225,134938,107171,984047,126879,990075,222585,687426,715803,603872,898154,390948,865369,238911,243048,962627,487995,1075725,822412,667119,832634,1072686,281653,1087021,885686,1038091,864884,740415,62087,306413,1162924,860512,659076,66145,858183,458724,46932,68581,436548,167082,368680,1184401,89678,799726,795867,621309,265905,802806,180139,1078829,727797,147956,719312,1066232,221319,455058,418828,395345,241533,565316,589698,545118,28128,921207,692960,368795,336758,651343,140134,907562,993474,193472,1192332,421108,779759,906966,1031712,1085187,1099841,1092408,1090864,313475,846536,711459,930818,361789,271635,917631,922388,926761,979893,1084900,808683,940859,1080499,347266,178194,829718,656709,937659,288743,1178918,196210,638750,718909,452843,597121,828732,912948,28778,557872,898431,964176,1124349,1087989,1137173,1181883,428125,534605,642312,884379,764129,888568,16944,94911,556458,48375,100634,868732,27169,415857,332672,889369,186676,1194144,827507,722174,609225,864289,750446,1062867,489475,64119,497677,1138019,82300,444878,26648,734732,1017695,1095976,1087092,81070,395139,61770,861465,135587,970124,1080453,446707,1151609,135090,612031,788793,78100,304259,818671,758378,168009,578573,450771,336056,85280,253688,360397,1197187,57357,738532,460304,1006950,1065698,906885,920317,637489,345506,701193,568278,906234,113778,322953,672653,485626,805572,34842,836207,927879,594573,815308,970120,1193281,10447,49397,27024,911629,93300,470857,462567,672802,1075107,283123,357485,668382,1149623,1042466,861602,1063552,336976,492622,1152765,1074066,892666,638515,159068,1180350,538540,1069300,1142156,801879,1168327,614378,481419,862402,63410,129063,488118,2426,1058516,1013870,1160461,845655,402125,691033,810039,1030759,410595,195862,870138,1102881,406879,780027,535976,309107,652369,1151777,188638,963736,356538,1022629,900034,77352,1035718,707559,714666,327044,293592,984409,698674,934932,532048,882751,1158047,646736,697035,441046,288582,927921,607960,603714,562536,1129893,458911,762628,96359,447476,1025884,140405,451951,598064,587313,726277,1089761,275690,355941,1089074,484603,907389,1080961,494523,246822,1138618,1157522,1078439,945798,743522,1080932,114445,678180,336067,973084,255322,995318,895328,1030584,554496,278783,571603,568277,934441,4713,47400,46596,1159566,931219,1031592,875784,1190932,374235,245046,914848,349123,513359,887734,778043,188857,776808,280153,266605,227202,1046536,1074888,470051,433870,226325,624374,73282,822432,102979,617772,593341,821983,787112,768908,272387,73344,271679,874604,928924,1070283,970538,185484,72539,214775,537192,753744,288418,761545,692515,940100,924154,234520,697642,92531,596582,457252,832882,67755,971991,1133548,397292,434230,854534,351101,1029720,963724,695022,911930,1187641,951235,736431,1017242,694856,801968,1054066,736515,1044016,271668,1184881,927290,435362,74316,410338,256575,396296,972539,53084,260862,479068,84523,40929,465781,1069660,572284,528606,926684,755670,1073462,1156560,657710,258315,437437,250760,282904,544413,744767,707566,517217,1090499,1024382,574484,773418,55403,743284,605712,514757,991021,1094626,827950,207283,1001780,730006,138905,829616,1137661,595758,936281,819397,647473,275853,550524,895454,1070745,1117795,254112,381439,715588,677972,212718,1051103,448186,168210,899371,807378,610483,124232,174901,265051,929964,488947,580443,419245,613836,194560,455141,473809,1061173,348893,1010564,962485,899146,1163548,32478,425019,685634,943345,446595,716550,1098701,900201,159107,80277,1197832,1033138,398678,876001,1060418,79720,135997,187983,270025,803823,247564,576401,614244,666914,624664,279819,103095,940003,65990,437944,326783,467133,74307,664201,473071,312481,130350,128139,193604,1063251,440716,12244,878901,729626,74836,119670,660568,1112217,644147,642017,818877,938141,1069941,1032684,25765,481812,559780,993120,594102,921914,1117988,800566,1063607,1181753,500792,733127,762852,966477,916416,449544,201696,447597,8999,158379,247596,871858,510081,1098043,291111,279197,874715,194109,1195688,406815,189113,744302,644930,121394,1153021,1041560,59362,493304,1084887,1175374,721095,1092553,595092,552847,66967,435568,254079,114189,710686,1169371,1118295,527584,1000294,712773,1007331,1101560,527815,474882,747087,1161781,752926,598205,204369,529389,406061,1089814,1176881,145981,118330,119356,1130999,412075,382337,545403,375700,854626,152219,280971,1154899,784378,11581,410846,304391,689590,777986,598575,550508,148685,523786,303190,1019929,381750,329778,1050919,845950,467627,517021,628666,15019,479741,270508,358733,210395,681509,1083363,1031926,1039294,478131,156700,881990,1058116,315860,665377,847907,378254,698808,749437,769786,666342,1184015,194851,633471,1061618,975669,423168,181227,341638,780498,429370,161239,1045084,98617,254363,489968,535040,353077,404414,821584,60895,382889,550192,675530,803595,688355,869282,88372,497557,928616,173391,924786,378911,138024,520282,897876,1044008,497324,312361,1119028,219230,673512,217433,1042089,712912,680801,686542,491090,36892,519745,469982,1182072,1087407,780513,6265,599133,386055,1102905,927992,1001425,1158843,957503,52862,532411,228258,13888,33671,320336,209350,205799,928133,618481,961955,273803,866986,155270,483246,845696,443719,370374,126902,341314,334918,1034740,738142,678305,404435,229237,1153179,179097,518498,899762,561170,123982,38165,554664,332331,923308,136022,680889,600488,504162,323936,501035,1067312,907865,833320,891980,819221,819581,249709,1174517,932874,1074166,468128,762286,158505,287757,237076,485410,907879,438422,22728,1082720,1197812,399197,613540,157265,520088,379629,252775,953687,1061565,74478,633128,1151971,706885,556888,1098256,273425,746503,861535,557259,218107,1786,1139781,700968,924448,328229,414565,833686,152866,2257,1033175,553100,119082,473150,480290,359918,331368,530786,537555,99251,342340,148480,315816,708404,841371,234732,708163,450772,307849,194345,529241,986454,523247,1129791,939863,420727,743897,87955,279066,975589,283566,1040675,1060937,1015340,430925,628351,513657,868615,931226,834143,441158,723641,1162391,319790,35319,560359,236320,244444,1122328,586448,1163712,198854,340464,349248,581727,143887,477819,570717,399978,149331,273279,72401,513098,1061275,1066022,154384,314947,60586,712285,395375,593404,243023,469721,157532,177305,746040,742485,379566,831735,72997,474860,169560,1158513,681165,3842,654077,897461,769103,762427,973642,90869,751457,101453,530738,693410,854536,294687,49769,316749,749055,762131,936347,155816,657277,491136,1135532,744411,1164610,28669,38192,991156,880924,1174753,266427,455724,802262,1147775,453438,587090,1026033,729886,1127583,920707,419488,948021,339573,321984,449373,232769,966778,812676,929922,475560,792037,826829,677224,944177,939991,404474,327245,614390,142935,973101,973884,453261,787405,890824,1078326,538946,399987,1093549,56783,156216,157206,986220,1133280,768282,1156835,89271,299165,735409,1090852,651959,735837,999066,606620,62502,581318,897821,199231,489154,731999,232161,145419,395611,1125038,822662,803855,543021,472238,1045373,333361,624042,1051439,555282,871620,34861,300274,603952,1037756,729581,146070,4069,241493,495515,1019422,305727,145549,322944,926516,702122,721757,390734,911262,860621,1178756,1171501,941435,408320,868494,750030,816169,645513,449847,41542,1146105,833969,556852,915627,1139409,411243,1087022,857479,1147156,1140437,168391,586228,180766,166174,820935,396023,286483,230364,513996,891090,763750,796292,614144,1091452,500893,280382,995688,43386,649880,672221,690240,414651,804046,1145889,936276,960432,102148,96169,1014482,670911,500899,111140,451997,498623,811979,222824,1134439,424556,566584,765652,1060223,787761,433780,368793,393172,433213,787109,853529,1143273,444766,789670,500262,107784,466290,1089269,974643,609606,900151,371376,617432,599073,880394,549410,1167946,578516,860489,109756,1151893,510869,436385,1170580,562300,598259,1077353,428494,908951,152543,726551,549529,207475,378360,105028,329517,26379,1133929,433154,55160,409099,460699,647914,1015457,724949,210065,405171,1034343,1153592,510416,35265,885456,337215,939635,861518,1036778,760164,109709,81460,177138,664285,499845,1087374,513263,1363,1090532,93551,579386,282019,347907,68722,53604,1168275,883061,800444,910618,1054714,429594,1031357,315943,720358,315654,485614,1144056,1122224,1123814,603681,295286,1124991,950310,470124,770921,999584,372366,248365,746133,515396,937963,100382,788410,98652,465199,713000,594747,699614,778134,18182,1117075,195775,927985,793,395388,226713,462787,457667,1107787,1000733,310710,963626,1063146,1006289,541229,699780,888096,151757,133714,1086271,475478,708849,270066,845417,1124986,1091345,1122880,591237,265461,147823,876600,937559,713281,1055147,196773,333262,1020373,1036733,831398,1192189,860466,758517,1039560,163555,414046,1096147,1056019,759970,789543,488308,633501,215408,653376,303191,991722,490815,605331,478895,172010,341980,718352,589089,950047,700079,840770,414005,1054553,178597,245026,280907,563985,992704,347404,1077952,305635,344431,1071693,735341,612766,424025,1167529,360025,907462,219931,69701,1192895,115620,1081223,292775,67908,250563,1047359,624066,374471,776680,296406,683257,898848,1182667,1077376,977814,1021284,499857,748890,623962,911837,216649,392838,269703,301829,1071064,506329,301498,822933,348244,147611,866079,579318,1002014,119973,500414,612644,271036,1040490,288827,7611,971103,1021663,592133,151690,825502,967402,1182723,695865,1095049,877199,814700,148761,776216,205563,396499,38842,627821,1086395,572053,1054018,892370,601220,224015,1086170,928223,476013,1193157,1111953,902309,602801,1155826,994271,476032,657224,788026,147411,517074,331776,1003140,707078,1103342,582343,739590,569323,183863,269008,736398,749992,689954,95286,761562,212996,398043,816231,94760,23391,352694,424966,982524,1153305,219258,1081797,875091,371006,271293,979777,762669,137953,126817,342747,649041,376274,238861,455317,301701,1087317,922981,973144,959064,350732,655374,255412,852850,1126530,670653,589819,726314,46102,716852,966754,291563,708524,1050774,143641,228255,98509,904557,691758,727341,1029538,106993,14488,1080686,1062962,205972,840646,317430,709384,754374,489223,1181878,569160,1187361,462628,150256,539586,318722,208370,292796,673642,144766,843567,592372,598703,534255,930114,1050221,167059,1017441,1072068,940445,777387,721434,1115028,427616,514996,239953,803379,790662,74781,472974,652398,333774,955361,568206,540976,647665,850514,1123627,1086066,267508,1114063,91508,698399,305290,491198,584779,317955,277681,505611,186747,389528,184555,1117141,730275,937789,216076,980396,75670,556652,566622,891867,412369,476046,262326,1116855,410910,895305,481264,442163,1129550,549264,493844,230079,166424,957671,106410,884116,994084,958417,629446,777098,486690,745349,1064226,494754,919491,1172932,113891,729805,1016188,473009,863234,556806,1015068,914743,914696,1042344,708613,936513,265778,790852,705856,827947,291904,674585,1101428,656896,455274,316521,1189846,1055012,410475,1184540,961229,384708,759142,183319,38563,111007,609285,369950,105860,822913,912384,362473,147343,38988,103842,236751,68037,206103,739772,227973,864397,100252,861077,297174,585739,795098,747034,260590,962886,370868,569616,305779,1074947,3919,878300,908899,421226,1045576,597745,698,678891,648267,643034,886302,435713,956388,353561,1129198,893480,441556,279984,241264,964513,5157,702383,548216,102755,945735,124401,200242,725821,773262,861452,502278,750360,1092507,694533,328181,570420,390890,105213,1101627,1034108,593751,39842,1174765,1126024,566423,514655,273892,752725,277407,1045843,254962,367109,1168601,74146,413204,884821,277445,1172058,805189,55394,997147,822208,430942,148832,1169681,760692,791466,159892,701321,552025,489582,640213,186822,670165,1175944,218158,959391,711691,377199,505168,701638,1195054,318838,530601,963526,289603,882518,541792,394292,1189560,735647,367991,251647,422996,240507,751754,110541,574856,1063143,1090910,214034,1071202,208006,975496,510655,482278,594209,299927,807133,332712,959170,955033,235454,710086,122356,375669,530962,365447,125395,916428,111060,312395,159990,333197,457666,1135994,891668,35157,337569,539005,1131936,339898,739357,1151149,1129500,761533,1030999,829401,13680,1108403,398355,402214,576772,932176,395275,1017942,119252,470284,1050125,478769,131849,976762,743023,779253,802736,956548,632765,608383,652963,1169953,276874,505121,829286,861323,546738,1057947,290519,204607,1004609,5749,776973,418322,291115,166369,112894,98240,105673,107217,884606,351545,486622,267263,836292,926446,280450,275693,271320,218188,113181,389398,257222,117582,850815,1019887,368363,541372,260422,909338,19163,1001871,559331,479172,745238,600960,369349,285133,1169303,640209,299650,233905,73732,110092,60908,16198,769956,663476,555769,313702,433952,309513,1181137,1103170,641623,1149706,1097447,329349,1170912,782224,865409,308712,1011405,3937,370574,475907,588856,333792,447635,135214,708606,1133962,700404,60062,1115781,753203,1171433,463349,180386,102105,110989,1117011,802942,1136311,336616,1062494,227957,117628,751374,46472,1062991,586050,409288,1119981,893822,379410,439703,1030072,619508,747310,862025,1112801,944393,837684,894,1140724,459549,737777,191131,132383,291196,277764,560592,852575,496888,629803,291847,1084303,875128,525428,712455,392509,1163239,361874,270202,603508,382773,227961,4800,1187634,1148684,1171057,286452,1104781,727224,735514,525279,122974,914958,840596,529699,48458,155615,336479,134529,861105,705459,45316,124015,305415,559566,1039013,17731,659541,128781,55925,396202,29754,583703,716662,335679,1134671,1069018,709963,1195655,139565,184211,37620,352426,795956,507048,388042,167322,787486,1002219,327943,95200,791202,418054,662105,888974,545712,46304,1009443,234345,841543,175452,298047,1120729,162363,490522,483415,871037,904489,213672,499407,263149,666033,315330,40034,551345,501046,757035,909499,270160,590121,594367,635545,68188,739170,435453,1101722,750605,172197,1057676,746130,600017,610768,471804,108320,922391,842140,109007,713478,290692,117120,703558,951259,59463,40559,119642,252283,454559,117149,1083636,519901,862014,224997,942759,202763,302753,167497,643585,919298,626478,629804,263640,1193368,1150681,1151485,38515,266862,166489,322297,7149,823846,953035,283233,848958,684722,310347,420038,1009224,421273,917928,931476,970879,151545,123193,728030,764211,971756,573707,1124799,375649,1095102,580309,604740,376098,410969,429173,925694,1124737,926402,323477,269157,127798,227543,1012597,1125542,983306,660889,444337,909663,436536,505566,257981,273927,963561,500439,1105550,601499,740829,365199,1130326,226090,64533,800789,763851,343547,846980,168361,234357,503059,286151,10440,246846,461650,180839,503225,396113,144015,461566,154065,926413,13200,270791,762719,1123765,787743,941506,801785,225542,1144997,937219,719013,1113558,1157152,732300,128421,625797,669475,271397,442411,124619,41521,540371,939766,760644,947321,915177,653668,453314,490515,680864,107582,173699,623597,424663,1142678,454797,592369,683324,207060,103455,370131,990798,196301,468075,1059176,368465,60420,602323,261800,378684,550608,922228,647557,302627,127336,80286,943969,816642,482493,520109,985363,146978,749895,1029871,298710,390703,587598,1073849,1023180,933030,268117,709134,617638,778836,584245,1003521,742940,724272,136908,849188,187517,235596,298935,34533,1165603,773062,512447,254736,751486,481531,99380,297880,1038974,1117804,249,164943,799403,322080,137663,1118361,1062084,1010098,928056,394258,950517,621680,583837,531167,573417,918262,1094986,258078,1132091,760137,871298,730948,1123774,533880,725010,885600,1067731,1069942,1004477,134830,757365,1185837,319180,468455,1123245,1078411,537513,85864,553934,556064,379204,259940,128140,165397,1172316,716269,638301,204961,603979,276167,80093,397515,134474};

/* multiplication inverses of omega */

/* (in Montgomery form) */
static const uint32_t w_3_inv[2]={658451,523302};

static const uint32_t w_5_inv[4][4]={{38216,492719,10316,640502},
{492719,640502,38216,10316},
{10316,38216,640502,492719},
{640502,10316,492719,38216}};

static const uint32_t omega_256_inv[128]={16328,379204,1069942,573417,164943,298935,933030,943969,468075,107582,271397,787743,246846,365199,983306,604740,917928,266862,942759,117120,750605,40034,175452,787486,335679,45316,727224,392509,191131,379410,802942,135214,1097447,110092,19163,275693,291115,1169953,119252,1151149,111060,299927,240507,1195054,701321,884821,1174765,861452,441556,421226,297174,912384,1055012,708613,494754,493844,556652,584779,955361,940445,208370,205972,708524,959064,979777,398043,707078,1193157,205563,971103,822933,977814,1081223,305635,589089,789543,333262,270066,1000733,594747,470124,429594,1363,885456,433154,598259,617432,787109,498623,690240,230364,1139409,1171501,241493,1045373,581318,986220,142935,232769,802262,155816,973642,742485,1061275,1163712,868615,939863,148480,152866,1098256,399197,932874,680889,404435,273803,1158843,491090,520282,382889,341638,847907,270508,148685,375700,598205,710686,1041560,510081};
static const uint32_t omega_1024_inv[512]={16328,972230,406085,1094156,379204,1095356,752378,734841,1069942,1191812,173077,151165,573417,87743,806585,441514,164943,453132,810642,626877,298935,620215,1170483,95720,933030,995265,490809,1187536,943969,97943,384321,372339,468075,144102,974816,766985,107582,81128,756249,107571,271397,1094018,587886,867247,787743,41316,603993,107415,246846,2708,211140,604167,365199,1003276,791565,43775,983306,951125,701901,770388,604740,800977,726298,931221,917928,599981,1104175,473735,266862,572308,427771,6576,942759,660156,398400,491425,117120,120,756166,562989,750605,1123970,509354,734592,40034,233274,262933,1113650,175452,240778,184378,616415,787486,238950,326771,546591,335679,688995,75586,1097500,45316,250465,902500,506672,727224,815833,1128947,900945,392509,770071,424291,841301,191131,458069,151457,97131,379410,37215,1179706,126418,802942,828186,715278,179954,135214,159719,521869,23858,1097447,90735,570900,820583,110092,122867,251772,731873,19163,1164957,378049,706224,275693,848514,135899,183043,291115,65358,1023837,102935,1169953,549910,543137,176095,119252,1134371,95683,919527,1151149,908333,142098,567270,111060,152329,480125,396988,299927,561294,552969,1109037,240507,733089,333415,639891,1195054,514337,804567,385045,701321,1109189,878829,966976,884821,466145,961643,7123,1174765,201293,475265,922371,861452,712857,559262,847577,441556,309793,470466,174793,421226,597017,637706,106222,297174,366112,786002,312601,912384,649077,14168,540133,1055012,762157,515121,313551,708613,14229,465253,53261,494754,587272,1031737,363182,493844,643738,656167,561659,556652,575060,1075916,457748,584779,478113,18903,325318,955361,78314,635947,144274,940445,495663,983769,893431,208370,920870,248907,949145,205972,466677,799608,226687,708524,791263,257367,345203,959064,69725,966147,193714,979777,19417,1128131,311724,398043,458281,1167862,13472,707078,425454,2891,1184581,1193157,761071,21648,549961,205563,25989,288499,114457,971103,512880,629027,468338,822933,741051,65819,673988,977814,209684,1173745,962368,1081223,1131674,892355,1175672,305635,507288,854889,1070065,589089,1079613,770775,227885,789543,601077,662261,583761,333262,454532,447291,6596,270066,154947,723181,279393,1000733,122552,363478,601868,594747,910218,538596,1174082,470124,535690,793541,1153475,429594,930917,839365,132207,1363,821227,733684,388655,885456,374080,196790,1033792,433154,999663,768238,435337,598259,1155730,961122,1176970,617432,187219,487526,248463,787109,878499,684641,235162,498623,865928,403521,352718,690240,432802,1097866,794117,230364,496163,939578,244016,1139409,412394,773774,415702,1171501,240571,497401,873292,241493,995784,226888,717117,1045373,1065350,131211,674055,581318,1093108,644352,491677,986220,104124,535315,527164,142935,30835,114193,745235,232769,175777,391766,660819,802262,936209,1119250,1118210,155816,68902,1151505,196359,973642,597583,649982,1024436,742485,1074860,752357,662416,1061275,910696,874943,2124,1163712,20833,705858,724973,868615,542236,948218,774323,939863,542309,230106,1146760,148480,726857,519995,635172,152866,449437,789770,813442,1098256,256454,562477,239947,399197,102295,1130671,1141545,932874,970714,597580,810790,680889,873480,148200,559911,404435,880562,725152,59665,273803,320669,553950,42304,1158843,1028640,236742,71440,491090,901519,375324,1006969,520282,27539,271315,1096473,382889,853534,219377,372170,341638,758971,1165715,881342,847907,723891,959452,437988,270508,24828,220983,148759,148685,121679,433447,70414,375700,820383,846617,382633,598205,456031,767681,1138718,710686,317434,636192,589872,1041560,580467,782539,635441,510081,902766,1024695,837006};
static const uint32_t omega_1280_inv[1280]={16328,625861,1095073,835754,503679,379204,563449,837438,1156702,522963,1069942,650180,555974,904809,234711,573417,809786,823794,1090705,820948,164943,1140037,955252,659684,456532,298935,264485,418706,1170216,517205,933030,743445,655424,685658,416209,943969,468387,805954,644039,530221,468075,633742,790998,498989,923947,107582,398677,482987,1123146,433357,271397,455301,402831,103193,602680,787743,868116,26403,795509,1191766,246846,958505,197293,103177,1054649,365199,436434,1186422,246286,4286,983306,569360,920560,311690,807469,604740,1003183,158930,1092775,304627,917928,978609,787679,279830,732389,266862,1039518,446116,1000909,746971,942759,353474,1170,645795,946505,117120,686642,775019,572643,659048,750605,275945,477300,702863,5499,40034,255290,550464,351823,887003,175452,1180596,532641,697901,1045229,787486,864502,427776,1782,430635,335679,454863,345392,516861,466675,45316,958909,1065406,1187765,572850,727224,226863,20186,819967,1144110,392509,396251,1171450,553205,1173549,191131,296233,63326,946448,1053339,379410,584993,287287,1023723,713491,802942,363932,59659,74406,58016,135214,997026,585146,233497,271976,1097447,118589,898433,33167,1119054,110092,33059,875122,852163,114408,19163,1038671,485485,197944,508584,275693,706846,38200,994034,39598,291115,1016950,1168339,448854,484658,1169953,233799,1175949,686398,179540,119252,665343,769200,1185422,339445,1151149,360963,586647,739431,375212,111060,843838,81252,611142,20997,299927,996351,258652,378637,480887,240507,86183,521982,851028,1100733,1195054,218494,331384,249950,736432,701321,1181896,52110,285252,776002,884821,261313,1064046,68457,599040,1174765,585836,61390,522971,244917,861452,771815,923840,1108363,1167157,441556,419326,130031,117651,288533,421226,72837,1173430,632328,747805,297174,813122,637616,533135,970570,912384,38216,542065,462142,722797,1055012,519481,438253,946279,361017,708613,967436,933578,1138080,750584,494754,1120792,885081,404823,741900,493844,618507,814511,713090,74725,556652,173118,168798,1194247,925062,584779,1090768,164521,630629,593383,955361,950248,938951,94806,74502,940445,274316,1190956,813518,1132673,208370,272930,57297,153074,1178251,205972,1069008,226808,1049669,565553,708524,411431,979339,84690,389104,959064,1104880,488836,711246,347149,979777,142129,1173517,1095069,649226,398043,870324,1152974,400612,859832,707078,74095,1130517,308582,843014,1193157,415584,552913,735896,866270,205563,1165816,208256,947287,640914,971103,607539,935322,994780,82721,822933,477226,846338,447395,739187,977814,855750,850133,99847,322538,1081223,748213,153734,805265,862778,305635,1197825,43018,427782,281574,589089,797080,169616,1000631,962166,789543,940046,837444,238413,681417,333262,364933,13132,152033,557579,270066,688321,1194882,584357,581360,1000733,926306,1087099,397296,780569,594747,1063116,1029694,290,344389,470124,336230,989394,519779,1155698,429594,913088,518957,1162786,286854,1363,61123,53037,382200,97444,885456,1118689,1060627,1176503,162744,433154,389749,1084679,167470,369082,598259,697603,327784,106090,312431,617432,1004513,1077359,274315,1144324,787109,57372,56231,762764,582120,498623,629769,26536,1007160,1109920,690240,825615,943826,988497,623710,230364,339802,1025639,204328,1083184,1139409,424300,847966,885188,602123,1171501,535275,124246,1117837,866836,241493,538257,203474,796129,151581,1045373,314008,1073155,718671,344340,581318,240270,1015209,253454,1195944,986220,1071855,1121,756989,850545,142935,420317,815265,1129269,817815,232769,1068229,1040991,844435,364693,802262,1002359,72754,897217,836543,155816,848528,734590,1067009,459758,973642,396168,895237,757420,581560,742485,217701,492719,873071,1056411,1061275,243933,502642,1143141,733179,1163712,337170,494477,184538,758274,868615,532232,794709,1026677,685104,939863,690355,197890,386618,47688,148480,209261,1087288,824177,979546,152866,1063443,703305,249466,930083,1098256,703366,697856,144870,797162,399197,770007,478854,86050,310331,932874,657339,129863,670042,644145,680889,871267,797953,144598,94068,404435,619899,1029881,333907,490548,273803,32279,444592,620520,36328,1158843,921352,103723,157939,407541,491090,388646,1167066,990368,412269,520282,649974,534430,256879,367690,382889,1076786,1110042,388939,453270,341638,380159,768012,898332,115659,847907,530062,242073,28954,1143722,270508,932288,886850,229242,734262,148685,184173,510728,813978,1017935,375700,103937,552539,68662,573952,598205,575637,99779,745805,483492,710686,591011,567709,608312,1039428,1041560,1020261,1014442,429140,109537,510081,595099,704446,741014,1110727,1181753,572220,103008,362327,694402,818877,634632,360643,41379,675118,128139,547901,642107,293272,963370,624664,388295,374287,107376,377133,1033138,58044,242829,538397,741549,899146,933596,779375,27865,680876,265051,454636,542657,512423,781872,254112,729694,392127,554042,667860,730006,564339,407083,699092,274134,1090499,799404,715094,74935,764724,926684,742780,795250,1094888,595401,410338,329965,1171678,402572,6315,951235,239576,1000788,1094904,143432,832882,761647,11659,951795,1193795,214775,628721,277521,886391,390612,593341,194898,1039151,105306,893454,280153,219472,410402,918251,465692,931219,158563,751965,197172,451110,255322,844607,1196911,552286,251576,1080961,511439,423062,625438,539033,447476,922136,720781,495218,1192582,1158047,942791,647617,846258,311078,1022629,17485,665440,500180,152852,410595,333579,770305,1196299,767446,862402,743218,852689,681220,731406,1152765,239172,132675,10316,625231,470857,971218,1177895,378114,53971,805572,801830,26631,644876,24532,1006950,901848,1134755,251633,144742,818671,613088,910794,174358,484590,395139,834149,1138422,1123675,1140065,1062867,201055,612935,964584,926105,100634,1079492,299648,1164914,79027,1087989,1165022,322959,345918,1083673,1178918,159410,712596,1000137,689497,922388,491235,1159881,204047,1158483,906966,181131,29742,749227,713423,28128,964282,22132,511683,1018541,1078829,532738,428881,12659,858636,46932,837118,611434,458650,822869,1087021,354243,1116829,586939,1177084,898154,201730,939429,819444,717194,957574,1111898,676099,347053,97348,3027,979587,866697,948131,461649,496760,16185,1145971,912829,422079,313260,936768,134035,1129624,599041,23316,612245,1136691,675110,953164,336629,426266,274241,89718,30924,756525,778755,1068050,1080430,909548,776855,1125244,24651,565753,450276,900907,384959,560465,664946,227511,285697,1159865,656016,735939,475284,143069,678600,759828,251802,837064,489468,230645,264503,60001,447497,703327,77289,313000,793258,456181,704237,579574,383570,484991,1123356,641429,1024963,1029283,3834,273019,613302,107313,1033560,567452,604698,242720,247833,259130,1103275,1123579,257636,923765,7125,384563,65408,989711,925151,1140784,1045007,19830,992109,129073,971273,148412,632528,489557,786650,218742,1113391,808977,239017,93201,709245,486835,850932,218304,1055952,24564,103012,548855,800038,327757,45107,797469,338249,491003,1123986,67564,889499,355067,4924,782497,645168,462185,331811,992518,32265,989825,250794,557167,226978,590542,262759,203301,1115360,375148,720855,351743,750686,458894,220267,342331,347948,1098234,875543,116858,449868,1044347,392816,335303,892446,256,1155063,770299,916507,608992,401001,1028465,197450,235915,408538,258035,360637,959668,516664,864819,833148,1184949,1046048,640502,928015,509760,3199,613724,616721,197348,271775,110982,800785,417512,603334,134965,168387,1197791,853692,727957,861851,208687,678302,42383,768487,284993,679124,35295,911227,1196718,1136958,1145044,815881,1100637,312625,79392,137454,21578,1035337,764927,808332,113402,1030611,828999,599822,500478,870297,1091991,885650,580649,193568,120722,923766,53757,410972,1140709,1141850,435317,615961,699458,568312,1171545,190921,88161,507841,372466,254255,209584,574371,967717,858279,172442,993753,114897,58672,773781,350115,312893,595958,26580,662806,1073835,80244,331245,956588,659824,994607,401952,1046500,152708,884073,124926,479410,853741,616763,957811,182872,944627,2137,211861,126226,1196960,441092,347536,1055146,777764,382816,68812,380266,965312,129852,157090,353646,833388,395819,195722,1125327,300864,361538,1042265,349553,463491,131072,738323,224439,801913,302844,440661,616521,455596,980380,705362,325010,141670,136806,954148,695439,54940,464902,34369,860911,703604,1013543,439807,329466,665849,403372,171404,512977,258218,507726,1000191,811463,1150393,1049601,988820,110793,373904,218535,1045215,134638,494776,948615,267998,99825,494715,500225,1053211,400919,798884,428074,719227,1112031,887750,265207,540742,1068218,528039,553936,517192,326814,400128,1053483,1104013,793646,578182,168200,864174,707533,924278,1165802,753489,577561,1161753,39238,276729,1094358,1040142,790540,706991,809435,31015,207713,785812,677799,548107,663651,941202,830391,815192,121295,88039,809142,744811,856443,817922,430069,299749,1082422,350174,668019,956008,1169127,54359,927573,265793,311231,968839,463819,1049396,1013908,687353,384103,180146,822381,1094144,645542,1129419,624129,599876,622444,1098302,452276,714589,487395,607070,630372,589769,158653,156521,177820,183639,768941,1088544,688000,602982,493635,457067,87354};
static const uint32_t omega_3072_inv[3072]={16328,76645,900925,972230,642083,1065202,406085,311226,77199,1094156,734389,99510,379204,937367,1053333,1095356,149493,505599,752378,740361,335637,734841,1109229,544145,1069942,731524,58252,1191812,1154639,535268,173077,336302,250967,151165,42081,1150464,573417,332707,885009,87743,251987,372852,806585,389389,525770,441514,279051,184670,164943,163549,140129,453132,494867,1079153,810642,919936,667661,626877,393756,1064963,298935,221361,508066,620215,254328,685489,1170483,304691,706539,95720,389443,163987,933030,978750,978519,995265,356990,758396,490809,533119,437782,1187536,826682,130568,943969,263541,795581,97943,72695,829406,384321,1111000,415759,372339,50240,512311,468075,687475,777559,144102,880852,404658,974816,1154792,508617,766985,521661,303724,107582,789844,1105099,81128,840448,66192,756249,786488,648210,107571,619487,960602,271397,257191,695773,1094018,993345,573975,587886,372963,129480,867247,566279,9953,787743,915099,38064,41316,85638,39,603993,621224,305658,107415,599677,871868,246846,1025612,693227,2708,5961,65770,211140,362131,105636,604167,919800,957591,365199,894593,1151188,1003276,1021004,15910,791565,202363,1013966,43775,1027660,62416,983306,850512,176830,951125,865061,257965,701901,151874,239635,770388,508358,350095,604740,209203,315837,800977,998206,377179,726298,592698,615385,931221,518630,87786,917928,719871,498472,599981,787592,972724,1104175,148112,683510,473735,883982,955728,266862,710425,374152,572308,1128839,1129722,427771,699628,892353,6576,5627,883517,942759,693567,475964,660156,610799,594618,398400,1101731,636476,491425,488463,143047,117120,1140887,816462,120,660359,160417,756166,699148,647079,562989,575206,483087,750605,837773,571302,1123970,4541,837769,509354,200094,618312,734592,847209,540752,40034,598681,1021869,233274,500223,161855,262933,964133,1042349,1113650,721555,220798,175452,1175497,81244,240778,500814,928105,184378,435063,1011218,616415,109697,1196662,787486,529183,583081,238950,944522,441285,326771,8333,858504,546591,612552,187466,335679,187214,27198,688995,356179,179249,75586,75245,784583,1097500,1005434,895682,45316,931507,155588,250465,763258,309500,902500,204554,201634,506672,596795,567331,727224,556688,36180,815833,1041526,348659,1128947,406156,212722,900945,83889,469139,392509,921970,1018113,770071,391303,215863,424291,718513,1032584,841301,97712,89441,191131,785727,843413,458069,277002,799994,151457,970042,302795,97131,676142,183214,379410,533446,709707,37215,71744,478241,1179706,569653,745608,126418,171212,206991,802942,280055,158565,828186,659477,877855,715278,53460,61049,179954,211192,1167455,135214,1011711,1063020,159719,728969,25640,521869,1128858,225894,23858,479898,483883,1097447,184623,635135,90735,1062013,139363,570900,888601,605321,820583,323754,9213,110092,125541,966085,122867,288601,721557,251772,637390,269571,731873,670891,330485,19163,851374,347733,1164957,985361,328110,378049,1021097,258120,706224,9639,717149,275693,894888,927529,848514,383910,736248,135899,837577,1130093,183043,127295,574420,291115,119202,1036634,65358,1018982,1049383,1023837,759665,974516,102935,706615,74651,1169953,483148,497231,549910,496422,1737,543137,1034099,342486,176095,350909,32267,119252,612903,831079,1134371,541974,993933,95683,1014505,4701,919527,323883,808955,1151149,399283,399780,908333,684150,800767,142098,995010,2048,567270,980598,844551,111060,739985,502930,152329,97734,430155,480125,405189,811846,396988,799545,386280,299927,9412,795843,561294,682523,763119,552969,1145996,866199,1109037,1164884,1052891,240507,1096161,635718,733089,333787,837835,333415,1067076,674779,639891,663966,910300,1195054,1044091,536141,514337,694631,180998,804567,286729,483837,385045,342778,1104056,701321,754062,462687,1109189,1122746,217749,878829,224563,976119,966976,742893,12048,884821,770430,1158812,466145,749590,693521,961643,818311,1079720,7123,90449,226974,1174765,725570,100891,201293,17929,909712,475265,617472,904403,922371,39914,1136403,861452,675189,999156,712857,898025,388927,559262,363045,1081863,847577,249563,1170956,441556,929505,300720,309793,647867,785935,470466,576381,709097,174793,554212,28960,421226,1174098,1178470,597017,411202,484859,637706,371139,635136,106222,94901,884481,297174,504617,1119197,366112,657252,1163629,786002,310014,476251,312601,1004447,1185066,912384,1121775,754925,649077,355909,790083,14168,170993,409581,540133,38229,200509,1055012,740247,966281,762157,31447,598803,515121,855629,350463,313551,142044,158712,708613,1065652,186749,14229,1115700,121718,465253,114077,739105,53261,573379,942282,494754,527203,1068927,587272,448593,886153,1031737,902703,952253,363182,807420,142143,493844,811005,551312,643738,338405,471941,656167,1133368,583566,561659,344873,3053,556652,676729,887516,575060,618147,575399,1075916,998625,875827,457748,97999,939967,584779,178094,159316,478113,395451,957646,18903,418997,199843,325318,269261,723227,955361,573538,1008553,78314,390946,677409,635947,685369,510124,144274,1148454,594653,940445,799079,357824,495663,227914,157492,983769,832507,486268,893431,1126509,987442,208370,594057,96760,920870,755547,697343,248907,596132,1082179,949145,152826,606287,205972,596742,944601,466677,602107,166686,799608,163880,474002,226687,324239,331922,708524,885390,1195966,791263,317613,750026,257367,1025323,1009808,345203,321439,99238,959064,414011,856926,69725,360094,906804,966147,1083061,231707,193714,53894,792002,979777,110534,980390,19417,1190829,307890,1128131,947655,1038816,311724,601239,1100942,398043,365196,848132,458281,1164084,644101,1167862,448018,367695,13472,174770,198011,707078,56646,281310,425454,758679,81306,2891,443920,400262,1184581,589675,523343,1193157,419196,885594,761071,1183780,165398,21648,997977,424899,549961,88178,998427,205563,252964,1126679,25989,1134508,267531,288499,339964,654554,114457,633760,361568,971103,1159449,746716,512880,893611,319926,629027,144538,444698,468338,1166313,420275,822933,775774,55670,741051,238938,758678,65819,970003,896883,673988,370484,75799,977814,859659,462861,209684,576598,475533,1173745,503883,534468,962368,65576,800905,1081223,520545,991447,1131674,706370,1072660,892355,37550,467565,1175672,395307,1123680,305635,949295,79714,507288,552139,272596,854889,870893,722074,1070065,240263,911576,589089,1032609,30395,1079613,746176,536467,770775,511422,1077104,227885,906450,276073,789543,37755,48157,601077,988210,121576,662261,862747,363477,583761,1185462,1054831,333262,1093727,80871,454532,611209,953883,447291,1089456,1028430,6596,315367,710573,270066,11371,1182851,154947,1106027,76092,723181,242959,731693,279393,688900,82995,1000733,1174236,919514,122552,202520,1049263,363478,599248,218350,601868,59536,709743,594747,61,944707,910218,1123201,75848,538596,196330,1031213,1174082,930678,495756,470124,72151,791045,535690,718186,760659,793541,852650,939849,1153475,479615,893386,429594,178485,224328,930917,602906,559989,839365,66905,1015751,132207,1167461,228136,1363,741404,913525,821227,712734,191205,733684,1161985,485075,388655,1139122,1037770,885456,1020027,460164,374080,655325,74124,196790,966747,790613,1033792,380301,1153472,433154,200479,590402,999663,178199,587370,768238,757576,970360,435337,462332,403628,598259,476760,1006998,1155730,658451,563246,961122,1136151,552971,1176970,130056,203111,617432,284923,70178,187219,104633,645759,487526,8700,551828,248463,908390,368828,787109,680989,967681,878499,1104258,235452,684641,18317,928263,235162,985735,129843,498623,542356,919562,865928,506303,872497,403521,139231,922778,352718,492387,1009985,690240,468198,196214,432802,739460,758822,1097866,683271,366585,794117,188514,991002,230364,960131,165506,496163,782928,626216,939578,550741,187228,244016,328318,5102,1139409,690215,81023,412394,974148,394124,773774,231776,64236,415702,687661,63898,1171501,495404,1009105,240571,889248,1040762,497401,786538,224479,873292,734876,453193,241493,791290,735762,995784,8176,823207,226888,1040964,31532,717117,978190,692366,1045373,23098,690588,1065350,301999,948370,131211,119381,214564,674055,210032,1173750,581318,491232,1093715,1093108,79066,56360,644352,262775,913349,491677,796944,839347,986220,452552,1097055,104124,1149443,336243,535315,900966,409116,527164,464934,1164129,142935,778738,432060,30835,705407,535651,114193,139435,487883,745235,340172,281607,232769,1065855,934448,175777,218367,865147,391766,197858,733729,660819,95951,372697,802262,531624,48256,936209,1090602,805317,1119250,1186923,917799,1118210,655496,326239,155816,187258,708626,68902,793184,116115,1151505,1120331,1155236,196359,282255,683697,973642,944269,117317,597583,790277,622484,649982,1192753,152853,1024436,451730,347551,742485,881838,99787,1074860,219406,183006,752357,415134,277612,662416,867070,221242,1061275,690767,243280,910696,139420,255578,874943,1144212,793254,2124,546201,563027,1163712,873342,311145,20833,356882,283881,705858,331802,48165,724973,439800,92115,868615,187037,880242,542236,259203,705511,948218,173349,954523,774323,347572,1067712,939863,172212,118938,542309,191673,793114,230106,558728,479554,1146760,717457,253365,148480,392321,406576,726857,863364,334308,519995,860164,1095310,635172,663754,23218,152866,27686,1058165,449437,778290,682370,789770,1157142,960637,813442,1152620,417121,1098256,732796,588420,256454,64583,997367,562477,1032429,836978,239947,810008,685826,399197,265979,214295,102295,379583,816535,1130671,747962,640386,1141545,224179,1019516,932874,958940,889785,970714,1125411,755850,597580,743816,1127658,810790,815850,106724,680889,617062,545138,873480,52189,744449,148200,848285,431630,559911,829460,22538,404435,1115458,1166188,880562,705752,1086342,725152,815811,700812,59665,311404,437723,273803,378402,497603,320669,155058,428922,553950,763690,1009479,42304,1009822,562021,1158843,946242,721143,1028640,862704,895617,236742,295494,844239,71440,562517,453828,491090,92642,643697,901519,586860,58354,375324,751857,1058201,1006969,706607,1148836,520282,512609,290877,27539,1177738,43262,271315,185338,925611,1096473,675338,910557,382889,499074,338507,853534,253385,458220,219377,931964,44661,372170,1027180,1015223,341638,222010,974481,758971,1009267,353303,1165715,743697,482786,881342,804802,331931,847907,567949,713542,723891,456000,582586,959452,432562,616823,437988,783615,483056,270508,866220,236183,24828,1125316,482666,220983,644385,773846,148759,1118951,150553,148685,1170994,1030062,121679,1059341,690934,433447,1143927,1171783,70414,247908,699672,375700,584564,442632,820383,820597,540572,846617,957096,1085701,382633,128645,1114493,598205,838543,515482,456031,1062683,931005,767681,517884,515294,1138718,771427,1024298,710686,822016,951167,317434,374015,846751,636192,885441,787722,589872,1178120,1166972,1041560,875217,595326,580467,490686,1024380,782539,592178,948712,635441,37433,1051748,510081,676414,801435,902766,729853,537257,1024695,868620,264472,837006,673583,88654,1181753,1121436,297156,225851,555998,132879,791996,886855,1120882,103925,463692,1098571,818877,260714,144748,102725,1048588,692482,445703,457720,862444,463240,88852,653936,128139,466557,1139829,6269,43442,662813,1025004,861779,947114,1046916,1156000,47617,624664,865374,313072,1110338,946094,825229,391496,808692,672311,756567,919030,1013411,1033138,1034532,1057952,744949,703214,118928,387439,278145,530420,571204,804325,133118,899146,976720,690015,577866,943753,512592,27598,893390,491542,1102361,808638,1034094,265051,219331,219562,202816,841091,439685,707272,664962,760299,10545,371399,1067513,254112,934540,402500,1100138,1125386,368675,813760,87081,782322,825742,1147841,685770,730006,510606,420522,1053979,317229,793423,223265,43289,689464,431096,676420,894357,1090499,408237,92982,1116953,357633,1131889,441832,411593,549871,1090510,578594,237479,926684,940890,502308,104063,204736,624106,610195,825118,1068601,330834,631802,1188128,410338,282982,1160017,1156765,1112443,1198042,594088,576857,892423,1090666,598404,326213,951235,172469,504854,1195373,1192120,1132311,986941,835950,1092445,593914,278281,240490,832882,303488,46893,194805,177077,1182171,406516,995718,184115,1154306,170421,1135665,214775,347569,1021251,246956,333020,940116,496180,1046207,958446,427693,689723,847986,593341,988878,882244,397104,199875,820902,471783,605383,582696,266860,679451,1110295,280153,478210,699609,598100,410489,225357,93906,1049969,514571,724346,314099,242353,931219,487656,823929,625773,69242,68359,770310,498453,305728,1191505,1192454,314564,255322,504514,722117,537925,587282,603463,799681,96350,561605,706656,709618,1055034,1080961,57194,381619,1197961,537722,1037664,441915,498933,551002,635092,622875,714994,447476,360308,626779,74111,1193540,360312,688727,997987,579769,463489,350872,657329,1158047,599400,176212,964807,697858,1036226,935148,233948,155732,84431,476526,977283,1022629,22584,1116837,957303,697267,269976,1013703,763018,186863,581666,1088384,1419,410595,668898,615000,959131,253559,756796,871310,1189748,339577,651490,585529,1010615,862402,1010867,1170883,509086,841902,1018832,1122495,1122836,413498,100581,192647,302399,1152765,266574,1042493,947616,434823,888581,295581,993527,996447,691409,601286,630750,470857,641393,1161901,382248,156555,849422,69134,791925,985359,297136,1114192,728942,805572,276111,179968,428010,806778,982218,773790,479568,165497,356780,1100369,1108640,1006950,412354,354668,740012,921079,398087,1046624,228039,895286,1100950,521939,1014867,818671,664635,488374,1160866,1126337,719840,18375,628428,452473,1071663,1026869,991090,395139,918026,1039516,369895,538604,320226,482803,1144621,1137032,1018127,986889,30626,1062867,186370,135061,1038362,469112,1172441,676212,69223,972187,1174223,718183,714198,100634,1013458,562946,1107346,136068,1058718,627181,309480,592760,377498,874327,1188868,1087989,1072540,231996,1075214,909480,476524,946309,560691,928510,466208,527190,867596,1178918,346707,850348,33124,212720,869971,820032,176984,939961,491857,1188442,480932,922388,303193,270552,349567,814171,461833,1062182,360504,67988,1015038,1070786,623661,906966,1078879,161447,1132723,179099,148698,174244,438416,223565,1095146,491466,1123430,28128,714933,700850,648171,701659,1196344,654944,163982,855595,1021986,847172,1165814,1078829,585178,367002,63710,656107,204148,1102398,183576,1193380,278554,874198,389126,46932,798798,798301,289748,513931,397314,1055983,203071,1196033,630811,217483,353530,1087021,458096,695151,1045752,1100347,767926,717956,792892,386235,801093,398536,811801,898154,1188669,402238,636787,515558,434962,645112,52085,331882,89044,33197,145190,957574,101920,562363,464992,864294,360246,864666,131005,523302,558190,534115,287781,3027,153990,661940,683744,503450,1017083,393514,911352,714244,813036,855303,94025,496760,444019,735394,88892,75335,980332,319252,973518,221962,231105,455188,1186033,313260,427651,39269,731936,448491,504560,236438,379770,118361,1190958,1107632,971107,23316,472511,1097190,996788,1180152,288369,722816,580609,293678,275710,1158167,61678,336629,522892,198925,485224,300056,809154,638819,835036,116218,350504,948518,27125,756525,268576,897361,888288,550214,412146,727615,621700,488984,1023288,643869,1169121,776855,23983,19611,601064,786879,713222,560375,826942,562945,1091859,1103180,313600,900907,693464,78884,831969,540829,34452,412079,888067,721830,885480,193634,13015,285697,76306,443156,549004,842172,407998,1183913,1027088,788500,657948,1159852,997572,143069,457834,231800,435924,1166634,599278,682960,342452,847618,884530,1056037,1039369,489468,132429,1011332,1183852,82381,1076363,732828,1084004,458976,1144820,624702,255799,703327,670878,129154,610809,749488,311928,166344,295378,245828,834899,390661,1055938,704237,387076,646769,554343,859676,726140,541914,64713,614515,636422,853208,1195028,641429,521352,310565,623021,579934,622682,122165,199456,322254,740333,1100082,258114,613302,1019987,1038765,719968,802630,240435,1179178,779084,998238,872763,928820,474854,242720,624543,189528,1119767,807135,520672,562134,512712,687957,1053807,49627,603428,257636,399002,840257,702418,970167,1040589,214312,365574,711813,304650,71572,210639,989711,604024,1101321,277211,442534,500738,949174,601949,115902,248936,1045255,591794,992109,601339,253480,731404,595974,1031395,398473,1034201,724079,971394,873842,866159,489557,312691,2115,406818,880468,448055,940714,172758,188273,852878,876642,1098843,239017,784070,341155,1128356,837987,291277,231934,115020,966374,1004367,1144187,406079,218304,1087547,217691,1178664,7252,890191,69950,250426,159265,886357,596842,97139,800038,832885,349949,739800,33997,553980,30219,750063,830386,1184609,1023311,1000070,491003,1141435,916771,772627,439402,1116775,1195190,754161,797819,13500,608406,674738,4924,778885,312487,437010,14301,1032683,1176433,200104,773182,648120,1109903,199654,992518,945117,71402,1172092,63573,930550,909582,858117,543527,1083624,564321,836513,226978,38632,451365,685201,304470,878155,569054,1053543,753383,729743,31768,777806,375148,422307,1142411,457030,959143,439403,1132262,228078,301198,524093,827597,1122282,220267,338422,735220,988397,621483,722548,24336,694198,663613,235713,1132505,397176,116858,677536,206634,66407,491711,125421,305726,1160531,730516,22409,802774,74401,892446,248786,1118367,690793,645942,925485,343192,327188,476007,128016,957818,286505,608992,165472,1167686,118468,451905,661614,427306,686659,120977,970196,291631,922008,408538,1160326,1149924,597004,209871,1076505,535820,335334,834604,614320,12619,143250,864819,104354,1117210,743549,586872,244198,750790,108625,169651,1191485,882714,487508,928015,1186710,15230,1043134,92054,1121989,474900,955122,466388,918688,509181,1115086,197348,23845,278567,1075529,995561,148818,834603,598833,979731,596213,1138545,488338,603334,1198020,253374,287863,74880,1122233,659485,1001751,166868,23999,267403,702325,727957,1125930,407036,662391,479895,437422,404540,345431,258232,44606,718466,304695,768487,1019596,973753,267164,595175,638092,358716,1131176,182330,1065874,30620,969945,1196718,456677,284556,376854,485347,1006876,464397,36096,713006,809426,58959,160311,312625,178054,737917,824001,542756,1123957,1001291,231334,407468,164289,817780,44609,764927,997602,607679,198418,1019882,610711,429843,440505,227721,762744,735749,794453,599822,721321,191083,42351,539630,634835,236959,61930,645110,21111,1068025,994970,580649,913158,1127903,1010862,1093448,552322,710555,1189381,646253,949618,289691,829253,410972,517092,230400,319582,93823,962629,513440,1179764,269818,962919,212346,1068238,699458,655725,278519,332153,691778,325584,794560,1058850,275303,845363,705694,188096,507841,729883,1001867,765279,458621,439259,100215,514810,831496,403964,1009567,207079,967717,237950,1032575,701918,415153,571865,258503,647340,1010853,954065,869763,1192979,58672,507866,1117058,785687,223933,803957,424307,966305,1133845,782379,510420,1134183,26580,702677,188976,957510,308833,157319,700680,411543,973602,324789,463205,744888,956588,406791,462319,202297,1189905,374874,971193,157117,1166549,480964,219891,505715,152708,1174983,507493,132731,896082,249711,1066870,1078700,983517,524026,988049,24331,616763,706849,104366,104973,1119015,1141721,553729,935306,284732,706404,401137,358734,211861,745529,101026,1093957,48638,861838,662766,297115,788965,670917,733147,33952,1055146,419343,766021,1167246,492674,662430,1083888,1058646,710198,452846,857909,916474,965312,132226,263633,1022304,979714,332934,806315,1000223,464352,537262,1102130,825384,395819,666457,1149825,261872,107479,392764,78831,11158,280282,79871,542585,871842,1042265,1010823,489455,1129179,404897,1081966,46576,77750,42845,1001722,915826,514384,224439,253812,1080764,600498,407804,575597,548099,5328,1045228,173645,746351,850530,455596,316243,1098294,123221,978675,1015075,445724,782947,920469,535665,331011,976839,136806,507314,954801,287385,1058661,942503,323138,53869,404827,1195957,651880,635054,34369,324739,886936,1177248,841199,914200,492223,866279,1149916,473108,758281,1105966,329466,1011044,317839,655845,938878,492570,249863,1024732,243558,423758,850509,130369,258218,1025869,1079143,655772,1006408,404967,967975,639353,718527,51321,480624,944716,1049601,805760,791505,471224,334717,863773,678086,337917,102771,562909,534327,1174863,1045215,1170395,139916,748644,419791,515711,408311,40939,237444,384639,45461,780960,99825,465285,609661,941627,1133498,200714,635604,165652,361103,958134,388073,512255,798884,932102,983786,1095786,818498,381546,67410,450119,557695,56536,973902,178565,265207,239141,308296,227367,72670,442231,600501,454265,70423,387291,382231,1091357,517192,581019,652943,324601,1145892,453632,1049881,349796,766451,638170,368621,1175543,793646,82623,31893,317519,492329,111739,472929,382270,497269,1138416,886677,760358,924278,819679,700478,877412,1043023,769159,644131,434391,188602,1155777,188259,636060,39238,251839,476938,169441,335377,302464,961339,902587,353842,1126641,635564,744253,706991,1105439,554384,296562,611221,1139727,822757,446224,139880,191112,491474,49245,677799,685472,907204,1170542,20343,1154819,926766,1012743,272470,101608,522743,287524,815192,699007,859574,344547,944696,739861,978704,266117,1153420,825911,170901,182858,856443,976071,223600,439110,188814,844778,32366,454384,715295,316739,393279,866150,350174,630132,484539,474190,742081,615495,238629,765519,581258,760093,414466,715025,927573,331861,961898,1173253,72765,715415,977098,553696,424235,1049322,79130,1047528,1049396,27087,168019,1076402,138740,507147,764634,54154,26298,1127667,950173,498409,822381,613517,755449,377698,377484,657509,351464,240985,112380,815448,1069436,83588,599876,359538,682599,742050,135398,267076,430400,680197,682787,59363,426654,173783,487395,376065,246914,880647,824066,351330,561889,312640,410359,608209,19961,31109,156521,322864,602755,617614,707395,173701,415542,605903,249369,562640,1160648,146333,688000,521667,396646,295315,468228,660824,173386,329461,933609,361075,524498,1109427};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* bit reverse step of dimension 1024 */
static void bit_reverse_1024(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[512];a[512]=t;
t=a[2];a[2]=a[256];a[256]=t;
t=a[3];a[3]=a[768];a[768]=t;
t=a[4];a[4]=a[128];a[128]=t;
t=a[5];a[5]=a[640];a[640]=t;
t=a[6];a[6]=a[384];a[384]=t;
t=a[7];a[7]=a[896];a[896]=t;
t=a[8];a[8]=a[64];a[64]=t;
t=a[9];a[9]=a[576];a[576]=t;
t=a[10];a[10]=a[320];a[320]=t;
t=a[11];a[11]=a[832];a[832]=t;
t=a[12];a[12]=a[192];a[192]=t;
t=a[13];a[13]=a[704];a[704]=t;
t=a[14];a[14]=a[448];a[448]=t;
t=a[15];a[15]=a[960];a[960]=t;
t=a[16];a[16]=a[32];a[32]=t;
t=a[17];a[17]=a[544];a[544]=t;
t=a[18];a[18]=a[288];a[288]=t;
t=a[19];a[19]=a[800];a[800]=t;
t=a[20];a[20]=a[160];a[160]=t;
t=a[21];a[21]=a[672];a[672]=t;
t=a[22];a[22]=a[416];a[416]=t;
t=a[23];a[23]=a[928];a[928]=t;
t=a[24];a[24]=a[96];a[96]=t;
t=a[25];a[25]=a[608];a[608]=t;
t=a[26];a[26]=a[352];a[352]=t;
t=a[27];a[27]=a[864];a[864]=t;
t=a[28];a[28]=a[224];a[224]=t;
t=a[29];a[29]=a[736];a[736]=t;
t=a[30];a[30]=a[480];a[480]=t;
t=a[31];a[31]=a[992];a[992]=t;
t=a[33];a[33]=a[528];a[528]=t;
t=a[34];a[34]=a[272];a[272]=t;
t=a[35];a[35]=a[784];a[784]=t;
t=a[36];a[36]=a[144];a[144]=t;
t=a[37];a[37]=a[656];a[656]=t;
t=a[38];a[38]=a[400];a[400]=t;
t=a[39];a[39]=a[912];a[912]=t;
t=a[40];a[40]=a[80];a[80]=t;
t=a[41];a[41]=a[592];a[592]=t;
t=a[42];a[42]=a[336];a[336]=t;
t=a[43];a[43]=a[848];a[848]=t;
t=a[44];a[44]=a[208];a[208]=t;
t=a[45];a[45]=a[720];a[720]=t;
t=a[46];a[46]=a[464];a[464]=t;
t=a[47];a[47]=a[976];a[976]=t;
t=a[49];a[49]=a[560];a[560]=t;
t=a[50];a[50]=a[304];a[304]=t;
t=a[51];a[51]=a[816];a[816]=t;
t=a[52];a[52]=a[176];a[176]=t;
t=a[53];a[53]=a[688];a[688]=t;
t=a[54];a[54]=a[432];a[432]=t;
t=a[55];a[55]=a[944];a[944]=t;
t=a[56];a[56]=a[112];a[112]=t;
t=a[57];a[57]=a[624];a[624]=t;
t=a[58];a[58]=a[368];a[368]=t;
t=a[59];a[59]=a[880];a[880]=t;
t=a[60];a[60]=a[240];a[240]=t;
t=a[61];a[61]=a[752];a[752]=t;
t=a[62];a[62]=a[496];a[496]=t;
t=a[63];a[63]=a[1008];a[1008]=t;
t=a[65];a[65]=a[520];a[520]=t;
t=a[66];a[66]=a[264];a[264]=t;
t=a[67];a[67]=a[776];a[776]=t;
t=a[68];a[68]=a[136];a[136]=t;
t=a[69];a[69]=a[648];a[648]=t;
t=a[70];a[70]=a[392];a[392]=t;
t=a[71];a[71]=a[904];a[904]=t;
t=a[73];a[73]=a[584];a[584]=t;
t=a[74];a[74]=a[328];a[328]=t;
t=a[75];a[75]=a[840];a[840]=t;
t=a[76];a[76]=a[200];a[200]=t;
t=a[77];a[77]=a[712];a[712]=t;
t=a[78];a[78]=a[456];a[456]=t;
t=a[79];a[79]=a[968];a[968]=t;
t=a[81];a[81]=a[552];a[552]=t;
t=a[82];a[82]=a[296];a[296]=t;
t=a[83];a[83]=a[808];a[808]=t;
t=a[84];a[84]=a[168];a[168]=t;
t=a[85];a[85]=a[680];a[680]=t;
t=a[86];a[86]=a[424];a[424]=t;
t=a[87];a[87]=a[936];a[936]=t;
t=a[88];a[88]=a[104];a[104]=t;
t=a[89];a[89]=a[616];a[616]=t;
t=a[90];a[90]=a[360];a[360]=t;
t=a[91];a[91]=a[872];a[872]=t;
t=a[92];a[92]=a[232];a[232]=t;
t=a[93];a[93]=a[744];a[744]=t;
t=a[94];a[94]=a[488];a[488]=t;
t=a[95];a[95]=a[1000];a[1000]=t;
t=a[97];a[97]=a[536];a[536]=t;
t=a[98];a[98]=a[280];a[280]=t;
t=a[99];a[99]=a[792];a[792]=t;
t=a[100];a[100]=a[152];a[152]=t;
t=a[101];a[101]=a[664];a[664]=t;
t=a[102];a[102]=a[408];a[408]=t;
t=a[103];a[103]=a[920];a[920]=t;
t=a[105];a[105]=a[600];a[600]=t;
t=a[106];a[106]=a[344];a[344]=t;
t=a[107];a[107]=a[856];a[856]=t;
t=a[108];a[108]=a[216];a[216]=t;
t=a[109];a[109]=a[728];a[728]=t;
t=a[110];a[110]=a[472];a[472]=t;
t=a[111];a[111]=a[984];a[984]=t;
t=a[113];a[113]=a[568];a[568]=t;
t=a[114];a[114]=a[312];a[312]=t;
t=a[115];a[115]=a[824];a[824]=t;
t=a[116];a[116]=a[184];a[184]=t;
t=a[117];a[117]=a[696];a[696]=t;
t=a[118];a[118]=a[440];a[440]=t;
t=a[119];a[119]=a[952];a[952]=t;
t=a[121];a[121]=a[632];a[632]=t;
t=a[122];a[122]=a[376];a[376]=t;
t=a[123];a[123]=a[888];a[888]=t;
t=a[124];a[124]=a[248];a[248]=t;
t=a[125];a[125]=a[760];a[760]=t;
t=a[126];a[126]=a[504];a[504]=t;
t=a[127];a[127]=a[1016];a[1016]=t;
t=a[129];a[129]=a[516];a[516]=t;
t=a[130];a[130]=a[260];a[260]=t;
t=a[131];a[131]=a[772];a[772]=t;
t=a[133];a[133]=a[644];a[644]=t;
t=a[134];a[134]=a[388];a[388]=t;
t=a[135];a[135]=a[900];a[900]=t;
t=a[137];a[137]=a[580];a[580]=t;
t=a[138];a[138]=a[324];a[324]=t;
t=a[139];a[139]=a[836];a[836]=t;
t=a[140];a[140]=a[196];a[196]=t;
t=a[141];a[141]=a[708];a[708]=t;
t=a[142];a[142]=a[452];a[452]=t;
t=a[143];a[143]=a[964];a[964]=t;
t=a[145];a[145]=a[548];a[548]=t;
t=a[146];a[146]=a[292];a[292]=t;
t=a[147];a[147]=a[804];a[804]=t;
t=a[148];a[148]=a[164];a[164]=t;
t=a[149];a[149]=a[676];a[676]=t;
t=a[150];a[150]=a[420];a[420]=t;
t=a[151];a[151]=a[932];a[932]=t;
t=a[153];a[153]=a[612];a[612]=t;
t=a[154];a[154]=a[356];a[356]=t;
t=a[155];a[155]=a[868];a[868]=t;
t=a[156];a[156]=a[228];a[228]=t;
t=a[157];a[157]=a[740];a[740]=t;
t=a[158];a[158]=a[484];a[484]=t;
t=a[159];a[159]=a[996];a[996]=t;
t=a[161];a[161]=a[532];a[532]=t;
t=a[162];a[162]=a[276];a[276]=t;
t=a[163];a[163]=a[788];a[788]=t;
t=a[165];a[165]=a[660];a[660]=t;
t=a[166];a[166]=a[404];a[404]=t;
t=a[167];a[167]=a[916];a[916]=t;
t=a[169];a[169]=a[596];a[596]=t;
t=a[170];a[170]=a[340];a[340]=t;
t=a[171];a[171]=a[852];a[852]=t;
t=a[172];a[172]=a[212];a[212]=t;
t=a[173];a[173]=a[724];a[724]=t;
t=a[174];a[174]=a[468];a[468]=t;
t=a[175];a[175]=a[980];a[980]=t;
t=a[177];a[177]=a[564];a[564]=t;
t=a[178];a[178]=a[308];a[308]=t;
t=a[179];a[179]=a[820];a[820]=t;
t=a[181];a[181]=a[692];a[692]=t;
t=a[182];a[182]=a[436];a[436]=t;
t=a[183];a[183]=a[948];a[948]=t;
t=a[185];a[185]=a[628];a[628]=t;
t=a[186];a[186]=a[372];a[372]=t;
t=a[187];a[187]=a[884];a[884]=t;
t=a[188];a[188]=a[244];a[244]=t;
t=a[189];a[189]=a[756];a[756]=t;
t=a[190];a[190]=a[500];a[500]=t;
t=a[191];a[191]=a[1012];a[1012]=t;
t=a[193];a[193]=a[524];a[524]=t;
t=a[194];a[194]=a[268];a[268]=t;
t=a[195];a[195]=a[780];a[780]=t;
t=a[197];a[197]=a[652];a[652]=t;
t=a[198];a[198]=a[396];a[396]=t;
t=a[199];a[199]=a[908];a[908]=t;
t=a[201];a[201]=a[588];a[588]=t;
t=a[202];a[202]=a[332];a[332]=t;
t=a[203];a[203]=a[844];a[844]=t;
t=a[205];a[205]=a[716];a[716]=t;
t=a[206];a[206]=a[460];a[460]=t;
t=a[207];a[207]=a[972];a[972]=t;
t=a[209];a[209]=a[556];a[556]=t;
t=a[210];a[210]=a[300];a[300]=t;
t=a[211];a[211]=a[812];a[812]=t;
t=a[213];a[213]=a[684];a[684]=t;
t=a[214];a[214]=a[428];a[428]=t;
t=a[215];a[215]=a[940];a[940]=t;
t=a[217];a[217]=a[620];a[620]=t;
t=a[218];a[218]=a[364];a[364]=t;
t=a[219];a[219]=a[876];a[876]=t;
t=a[220];a[220]=a[236];a[236]=t;
t=a[221];a[221]=a[748];a[748]=t;
t=a[222];a[222]=a[492];a[492]=t;
t=a[223];a[223]=a[1004];a[1004]=t;
t=a[225];a[225]=a[540];a[540]=t;
t=a[226];a[226]=a[284];a[284]=t;
t=a[227];a[227]=a[796];a[796]=t;
t=a[229];a[229]=a[668];a[668]=t;
t=a[230];a[230]=a[412];a[412]=t;
t=a[231];a[231]=a[924];a[924]=t;
t=a[233];a[233]=a[604];a[604]=t;
t=a[234];a[234]=a[348];a[348]=t;
t=a[235];a[235]=a[860];a[860]=t;
t=a[237];a[237]=a[732];a[732]=t;
t=a[238];a[238]=a[476];a[476]=t;
t=a[239];a[239]=a[988];a[988]=t;
t=a[241];a[241]=a[572];a[572]=t;
t=a[242];a[242]=a[316];a[316]=t;
t=a[243];a[243]=a[828];a[828]=t;
t=a[245];a[245]=a[700];a[700]=t;
t=a[246];a[246]=a[444];a[444]=t;
t=a[247];a[247]=a[956];a[956]=t;
t=a[249];a[249]=a[636];a[636]=t;
t=a[250];a[250]=a[380];a[380]=t;
t=a[251];a[251]=a[892];a[892]=t;
t=a[253];a[253]=a[764];a[764]=t;
t=a[254];a[254]=a[508];a[508]=t;
t=a[255];a[255]=a[1020];a[1020]=t;
t=a[257];a[257]=a[514];a[514]=t;
t=a[259];a[259]=a[770];a[770]=t;
t=a[261];a[261]=a[642];a[642]=t;
t=a[262];a[262]=a[386];a[386]=t;
t=a[263];a[263]=a[898];a[898]=t;
t=a[265];a[265]=a[578];a[578]=t;
t=a[266];a[266]=a[322];a[322]=t;
t=a[267];a[267]=a[834];a[834]=t;
t=a[269];a[269]=a[706];a[706]=t;
t=a[270];a[270]=a[450];a[450]=t;
t=a[271];a[271]=a[962];a[962]=t;
t=a[273];a[273]=a[546];a[546]=t;
t=a[274];a[274]=a[290];a[290]=t;
t=a[275];a[275]=a[802];a[802]=t;
t=a[277];a[277]=a[674];a[674]=t;
t=a[278];a[278]=a[418];a[418]=t;
t=a[279];a[279]=a[930];a[930]=t;
t=a[281];a[281]=a[610];a[610]=t;
t=a[282];a[282]=a[354];a[354]=t;
t=a[283];a[283]=a[866];a[866]=t;
t=a[285];a[285]=a[738];a[738]=t;
t=a[286];a[286]=a[482];a[482]=t;
t=a[287];a[287]=a[994];a[994]=t;
t=a[289];a[289]=a[530];a[530]=t;
t=a[291];a[291]=a[786];a[786]=t;
t=a[293];a[293]=a[658];a[658]=t;
t=a[294];a[294]=a[402];a[402]=t;
t=a[295];a[295]=a[914];a[914]=t;
t=a[297];a[297]=a[594];a[594]=t;
t=a[298];a[298]=a[338];a[338]=t;
t=a[299];a[299]=a[850];a[850]=t;
t=a[301];a[301]=a[722];a[722]=t;
t=a[302];a[302]=a[466];a[466]=t;
t=a[303];a[303]=a[978];a[978]=t;
t=a[305];a[305]=a[562];a[562]=t;
t=a[307];a[307]=a[818];a[818]=t;
t=a[309];a[309]=a[690];a[690]=t;
t=a[310];a[310]=a[434];a[434]=t;
t=a[311];a[311]=a[946];a[946]=t;
t=a[313];a[313]=a[626];a[626]=t;
t=a[314];a[314]=a[370];a[370]=t;
t=a[315];a[315]=a[882];a[882]=t;
t=a[317];a[317]=a[754];a[754]=t;
t=a[318];a[318]=a[498];a[498]=t;
t=a[319];a[319]=a[1010];a[1010]=t;
t=a[321];a[321]=a[522];a[522]=t;
t=a[323];a[323]=a[778];a[778]=t;
t=a[325];a[325]=a[650];a[650]=t;
t=a[326];a[326]=a[394];a[394]=t;
t=a[327];a[327]=a[906];a[906]=t;
t=a[329];a[329]=a[586];a[586]=t;
t=a[331];a[331]=a[842];a[842]=t;
t=a[333];a[333]=a[714];a[714]=t;
t=a[334];a[334]=a[458];a[458]=t;
t=a[335];a[335]=a[970];a[970]=t;
t=a[337];a[337]=a[554];a[554]=t;
t=a[339];a[339]=a[810];a[810]=t;
t=a[341];a[341]=a[682];a[682]=t;
t=a[342];a[342]=a[426];a[426]=t;
t=a[343];a[343]=a[938];a[938]=t;
t=a[345];a[345]=a[618];a[618]=t;
t=a[346];a[346]=a[362];a[362]=t;
t=a[347];a[347]=a[874];a[874]=t;
t=a[349];a[349]=a[746];a[746]=t;
t=a[350];a[350]=a[490];a[490]=t;
t=a[351];a[351]=a[1002];a[1002]=t;
t=a[353];a[353]=a[538];a[538]=t;
t=a[355];a[355]=a[794];a[794]=t;
t=a[357];a[357]=a[666];a[666]=t;
t=a[358];a[358]=a[410];a[410]=t;
t=a[359];a[359]=a[922];a[922]=t;
t=a[361];a[361]=a[602];a[602]=t;
t=a[363];a[363]=a[858];a[858]=t;
t=a[365];a[365]=a[730];a[730]=t;
t=a[366];a[366]=a[474];a[474]=t;
t=a[367];a[367]=a[986];a[986]=t;
t=a[369];a[369]=a[570];a[570]=t;
t=a[371];a[371]=a[826];a[826]=t;
t=a[373];a[373]=a[698];a[698]=t;
t=a[374];a[374]=a[442];a[442]=t;
t=a[375];a[375]=a[954];a[954]=t;
t=a[377];a[377]=a[634];a[634]=t;
t=a[379];a[379]=a[890];a[890]=t;
t=a[381];a[381]=a[762];a[762]=t;
t=a[382];a[382]=a[506];a[506]=t;
t=a[383];a[383]=a[1018];a[1018]=t;
t=a[385];a[385]=a[518];a[518]=t;
t=a[387];a[387]=a[774];a[774]=t;
t=a[389];a[389]=a[646];a[646]=t;
t=a[391];a[391]=a[902];a[902]=t;
t=a[393];a[393]=a[582];a[582]=t;
t=a[395];a[395]=a[838];a[838]=t;
t=a[397];a[397]=a[710];a[710]=t;
t=a[398];a[398]=a[454];a[454]=t;
t=a[399];a[399]=a[966];a[966]=t;
t=a[401];a[401]=a[550];a[550]=t;
t=a[403];a[403]=a[806];a[806]=t;
t=a[405];a[405]=a[678];a[678]=t;
t=a[406];a[406]=a[422];a[422]=t;
t=a[407];a[407]=a[934];a[934]=t;
t=a[409];a[409]=a[614];a[614]=t;
t=a[411];a[411]=a[870];a[870]=t;
t=a[413];a[413]=a[742];a[742]=t;
t=a[414];a[414]=a[486];a[486]=t;
t=a[415];a[415]=a[998];a[998]=t;
t=a[417];a[417]=a[534];a[534]=t;
t=a[419];a[419]=a[790];a[790]=t;
t=a[421];a[421]=a[662];a[662]=t;
t=a[423];a[423]=a[918];a[918]=t;
t=a[425];a[425]=a[598];a[598]=t;
t=a[427];a[427]=a[854];a[854]=t;
t=a[429];a[429]=a[726];a[726]=t;
t=a[430];a[430]=a[470];a[470]=t;
t=a[431];a[431]=a[982];a[982]=t;
t=a[433];a[433]=a[566];a[566]=t;
t=a[435];a[435]=a[822];a[822]=t;
t=a[437];a[437]=a[694];a[694]=t;
t=a[439];a[439]=a[950];a[950]=t;
t=a[441];a[441]=a[630];a[630]=t;
t=a[443];a[443]=a[886];a[886]=t;
t=a[445];a[445]=a[758];a[758]=t;
t=a[446];a[446]=a[502];a[502]=t;
t=a[447];a[447]=a[1014];a[1014]=t;
t=a[449];a[449]=a[526];a[526]=t;
t=a[451];a[451]=a[782];a[782]=t;
t=a[453];a[453]=a[654];a[654]=t;
t=a[455];a[455]=a[910];a[910]=t;
t=a[457];a[457]=a[590];a[590]=t;
t=a[459];a[459]=a[846];a[846]=t;
t=a[461];a[461]=a[718];a[718]=t;
t=a[463];a[463]=a[974];a[974]=t;
t=a[465];a[465]=a[558];a[558]=t;
t=a[467];a[467]=a[814];a[814]=t;
t=a[469];a[469]=a[686];a[686]=t;
t=a[471];a[471]=a[942];a[942]=t;
t=a[473];a[473]=a[622];a[622]=t;
t=a[475];a[475]=a[878];a[878]=t;
t=a[477];a[477]=a[750];a[750]=t;
t=a[478];a[478]=a[494];a[494]=t;
t=a[479];a[479]=a[1006];a[1006]=t;
t=a[481];a[481]=a[542];a[542]=t;
t=a[483];a[483]=a[798];a[798]=t;
t=a[485];a[485]=a[670];a[670]=t;
t=a[487];a[487]=a[926];a[926]=t;
t=a[489];a[489]=a[606];a[606]=t;
t=a[491];a[491]=a[862];a[862]=t;
t=a[493];a[493]=a[734];a[734]=t;
t=a[495];a[495]=a[990];a[990]=t;
t=a[497];a[497]=a[574];a[574]=t;
t=a[499];a[499]=a[830];a[830]=t;
t=a[501];a[501]=a[702];a[702]=t;
t=a[503];a[503]=a[958];a[958]=t;
t=a[505];a[505]=a[638];a[638]=t;
t=a[507];a[507]=a[894];a[894]=t;
t=a[509];a[509]=a[766];a[766]=t;
t=a[511];a[511]=a[1022];a[1022]=t;
t=a[515];a[515]=a[769];a[769]=t;
t=a[517];a[517]=a[641];a[641]=t;
t=a[519];a[519]=a[897];a[897]=t;
t=a[521];a[521]=a[577];a[577]=t;
t=a[523];a[523]=a[833];a[833]=t;
t=a[525];a[525]=a[705];a[705]=t;
t=a[527];a[527]=a[961];a[961]=t;
t=a[529];a[529]=a[545];a[545]=t;
t=a[531];a[531]=a[801];a[801]=t;
t=a[533];a[533]=a[673];a[673]=t;
t=a[535];a[535]=a[929];a[929]=t;
t=a[537];a[537]=a[609];a[609]=t;
t=a[539];a[539]=a[865];a[865]=t;
t=a[541];a[541]=a[737];a[737]=t;
t=a[543];a[543]=a[993];a[993]=t;
t=a[547];a[547]=a[785];a[785]=t;
t=a[549];a[549]=a[657];a[657]=t;
t=a[551];a[551]=a[913];a[913]=t;
t=a[553];a[553]=a[593];a[593]=t;
t=a[555];a[555]=a[849];a[849]=t;
t=a[557];a[557]=a[721];a[721]=t;
t=a[559];a[559]=a[977];a[977]=t;
t=a[563];a[563]=a[817];a[817]=t;
t=a[565];a[565]=a[689];a[689]=t;
t=a[567];a[567]=a[945];a[945]=t;
t=a[569];a[569]=a[625];a[625]=t;
t=a[571];a[571]=a[881];a[881]=t;
t=a[573];a[573]=a[753];a[753]=t;
t=a[575];a[575]=a[1009];a[1009]=t;
t=a[579];a[579]=a[777];a[777]=t;
t=a[581];a[581]=a[649];a[649]=t;
t=a[583];a[583]=a[905];a[905]=t;
t=a[587];a[587]=a[841];a[841]=t;
t=a[589];a[589]=a[713];a[713]=t;
t=a[591];a[591]=a[969];a[969]=t;
t=a[595];a[595]=a[809];a[809]=t;
t=a[597];a[597]=a[681];a[681]=t;
t=a[599];a[599]=a[937];a[937]=t;
t=a[601];a[601]=a[617];a[617]=t;
t=a[603];a[603]=a[873];a[873]=t;
t=a[605];a[605]=a[745];a[745]=t;
t=a[607];a[607]=a[1001];a[1001]=t;
t=a[611];a[611]=a[793];a[793]=t;
t=a[613];a[613]=a[665];a[665]=t;
t=a[615];a[615]=a[921];a[921]=t;
t=a[619];a[619]=a[857];a[857]=t;
t=a[621];a[621]=a[729];a[729]=t;
t=a[623];a[623]=a[985];a[985]=t;
t=a[627];a[627]=a[825];a[825]=t;
t=a[629];a[629]=a[697];a[697]=t;
t=a[631];a[631]=a[953];a[953]=t;
t=a[635];a[635]=a[889];a[889]=t;
t=a[637];a[637]=a[761];a[761]=t;
t=a[639];a[639]=a[1017];a[1017]=t;
t=a[643];a[643]=a[773];a[773]=t;
t=a[647];a[647]=a[901];a[901]=t;
t=a[651];a[651]=a[837];a[837]=t;
t=a[653];a[653]=a[709];a[709]=t;
t=a[655];a[655]=a[965];a[965]=t;
t=a[659];a[659]=a[805];a[805]=t;
t=a[661];a[661]=a[677];a[677]=t;
t=a[663];a[663]=a[933];a[933]=t;
t=a[667];a[667]=a[869];a[869]=t;
t=a[669];a[669]=a[741];a[741]=t;
t=a[671];a[671]=a[997];a[997]=t;
t=a[675];a[675]=a[789];a[789]=t;
t=a[679];a[679]=a[917];a[917]=t;
t=a[683];a[683]=a[853];a[853]=t;
t=a[685];a[685]=a[725];a[725]=t;
t=a[687];a[687]=a[981];a[981]=t;
t=a[691];a[691]=a[821];a[821]=t;
t=a[695];a[695]=a[949];a[949]=t;
t=a[699];a[699]=a[885];a[885]=t;
t=a[701];a[701]=a[757];a[757]=t;
t=a[703];a[703]=a[1013];a[1013]=t;
t=a[707];a[707]=a[781];a[781]=t;
t=a[711];a[711]=a[909];a[909]=t;
t=a[715];a[715]=a[845];a[845]=t;
t=a[719];a[719]=a[973];a[973]=t;
t=a[723];a[723]=a[813];a[813]=t;
t=a[727];a[727]=a[941];a[941]=t;
t=a[731];a[731]=a[877];a[877]=t;
t=a[733];a[733]=a[749];a[749]=t;
t=a[735];a[735]=a[1005];a[1005]=t;
t=a[739];a[739]=a[797];a[797]=t;
t=a[743];a[743]=a[925];a[925]=t;
t=a[747];a[747]=a[861];a[861]=t;
t=a[751];a[751]=a[989];a[989]=t;
t=a[755];a[755]=a[829];a[829]=t;
t=a[759];a[759]=a[957];a[957]=t;
t=a[763];a[763]=a[893];a[893]=t;
t=a[767];a[767]=a[1021];a[1021]=t;
t=a[775];a[775]=a[899];a[899]=t;
t=a[779];a[779]=a[835];a[835]=t;
t=a[783];a[783]=a[963];a[963]=t;
t=a[787];a[787]=a[803];a[803]=t;
t=a[791];a[791]=a[931];a[931]=t;
t=a[795];a[795]=a[867];a[867]=t;
t=a[799];a[799]=a[995];a[995]=t;
t=a[807];a[807]=a[915];a[915]=t;
t=a[811];a[811]=a[851];a[851]=t;
t=a[815];a[815]=a[979];a[979]=t;
t=a[823];a[823]=a[947];a[947]=t;
t=a[827];a[827]=a[883];a[883]=t;
t=a[831];a[831]=a[1011];a[1011]=t;
t=a[839];a[839]=a[907];a[907]=t;
t=a[847];a[847]=a[971];a[971]=t;
t=a[855];a[855]=a[939];a[939]=t;
t=a[859];a[859]=a[875];a[875]=t;
t=a[863];a[863]=a[1003];a[1003]=t;
t=a[871];a[871]=a[923];a[923]=t;
t=a[879];a[879]=a[987];a[987]=t;
t=a[887];a[887]=a[955];a[955]=t;
t=a[895];a[895]=a[1019];a[1019]=t;
t=a[911];a[911]=a[967];a[967]=t;
t=a[919];a[919]=a[935];a[935]=t;
t=a[927];a[927]=a[999];a[999]=t;
t=a[943];a[943]=a[983];a[983]=t;
t=a[959];a[959]=a[1015];a[1015]=t;
t=a[991];a[991]=a[1007];a[1007]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = montgomery((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = montgomery((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), void (*bit_reverse)(uint32_t *))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n, void (*bit_reverse)(uint32_t *))
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = montgomery((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = montgomery((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 8 --> 256 * 13 */
static void ntt_butterfly_2048_3328(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i;
	
	b = a[n2];
	c = a[N2_3328 + n2];
	d = a[N2_3328 * 2 + n2];
	e = a[N2_3328 * 3 + n2];
	f = a[N2_3328 * 4 + n2];
	g = a[N2_3328 * 5 + n2];
	h = a[N2_3328 * 6 + n2];
	i = a[N2_3328 * 7 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h + i);
	a[N2_3328 + n2] = barrett_4q(b + montgomery(c * w_13[0][0] + d * w_13[0][1] + e * w_13[0][2] + f * w_13[0][3] + g * w_13[0][4] + h * w_13[0][5] + i * w_13[0][6]));
	a[N2_3328 * 2 + n2] = barrett_4q(b + montgomery(c * w_13[1][0] + d * w_13[1][1] + e * w_13[1][2] + f * w_13[1][3] + g * w_13[1][4] + h * w_13[1][5] + i * w_13[1][6]));
	a[N2_3328 * 3 + n2] = barrett_4q(b + montgomery(c * w_13[2][0] + d * w_13[2][1] + e * w_13[2][2] + f * w_13[2][3] + g * w_13[2][4] + h * w_13[2][5] + i * w_13[2][6]));
	a[N2_3328 * 4 + n2] = barrett_4q(b + montgomery(c * w_13[3][0] + d * w_13[3][1] + e * w_13[3][2] + f * w_13[3][3] + g * w_13[3][4] + h * w_13[3][5] + i * w_13[3][6]));
	a[N2_3328 * 5 + n2] = barrett_4q(b + montgomery(c * w_13[4][0] + d * w_13[4][1] + e * w_13[4][2] + f * w_13[4][3] + g * w_13[4][4] + h * w_13[4][5] + i * w_13[4][6]));
	a[N2_3328 * 6 + n2] = barrett_4q(b + montgomery(c * w_13[5][0] + d * w_13[5][1] + e * w_13[5][2] + f * w_13[5][3] + g * w_13[5][4] + h * w_13[5][5] + i * w_13[5][6]));
	a[N2_3328 * 7 + n2] = barrett_4q(b + montgomery(c * w_13[6][0] + d * w_13[6][1] + e * w_13[6][2] + f * w_13[6][3] + g * w_13[6][4] + h * w_13[6][5] + i * w_13[6][6]));
	a[N2_3328 * 8 + n2] = barrett_4q(b + montgomery(c * w_13[7][0] + d * w_13[7][1] + e * w_13[7][2] + f * w_13[7][3] + g * w_13[7][4] + h * w_13[7][5] + i * w_13[7][6]));
	a[N2_3328 * 9 + n2] = barrett_4q(b + montgomery(c * w_13[8][0] + d * w_13[8][1] + e * w_13[8][2] + f * w_13[8][3] + g * w_13[8][4] + h * w_13[8][5] + i * w_13[8][6]));
	a[N2_3328 * 10 + n2] = barrett_4q(b + montgomery(c * w_13[9][0] + d * w_13[9][1] + e * w_13[9][2] + f * w_13[9][3] + g * w_13[9][4] + h * w_13[9][5] + i * w_13[9][6]));
	a[N2_3328 * 11 + n2] = barrett_4q(b + montgomery(c * w_13[10][0] + d * w_13[10][1] + e * w_13[10][2] + f * w_13[10][3] + g * w_13[10][4] + h * w_13[10][5] + i * w_13[10][6]));
	a[N2_3328 * 12 + n2] = barrett_4q(b + montgomery(c * w_13[11][0] + d * w_13[11][1] + e * w_13[11][2] + f * w_13[11][3] + g * w_13[11][4] + h * w_13[11][5] + i * w_13[11][6]));
}

/* 256 * 13 --> 256 * 5 */
static void ntt_butterfly_3328_1280(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k, l, m, n;
	
	b = a[n2];
	c = a[N2_3328 + n2];
	d = a[N2_3328 * 2 + n2];
	e = a[N2_3328 * 3 + n2];
	f = a[N2_3328 * 4 + n2];
	g = a[N2_3328 * 5 + n2];
	h = a[N2_3328 * 6 + n2];
	i = a[N2_3328 * 7 + n2];
	j = a[N2_3328 * 8 + n2];
	k = a[N2_3328 * 9 + n2];
	l = a[N2_3328 * 10 + n2];
	m = a[N2_3328 * 11 + n2];
	n = a[N2_3328 * 12 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j + k + l + m + n);
	a[N2_3328 + n2] = barrett_4q(b + montgomery(c * w_13[0][0] + d * w_13[0][1] + e * w_13[0][2] + f * w_13[0][3] + g * w_13[0][4] + h * w_13[0][5] + i * w_13[0][6] + j * w_13[0][7] + k * w_13[0][8] + l * w_13[0][9] + m * w_13[0][10] + n * w_13[0][11]));
	a[N2_3328 * 2 + n2] = barrett_4q(b + montgomery(c * w_13[1][0] + d * w_13[1][1] + e * w_13[1][2] + f * w_13[1][3] + g * w_13[1][4] + h * w_13[1][5] + i * w_13[1][6] + j * w_13[1][7] + k * w_13[1][8] + l * w_13[1][9] + m * w_13[1][10] + n * w_13[1][11]));
	a[N2_3328 * 3 + n2] = barrett_4q(b + montgomery(c * w_13[2][0] + d * w_13[2][1] + e * w_13[2][2] + f * w_13[2][3] + g * w_13[2][4] + h * w_13[2][5] + i * w_13[2][6] + j * w_13[2][7] + k * w_13[2][8] + l * w_13[2][9] + m * w_13[2][10] + n * w_13[2][11]));
	a[N2_3328 * 4 + n2] = barrett_4q(b + montgomery(c * w_13[3][0] + d * w_13[3][1] + e * w_13[3][2] + f * w_13[3][3] + g * w_13[3][4] + h * w_13[3][5] + i * w_13[3][6] + j * w_13[3][7] + k * w_13[3][8] + l * w_13[3][9] + m * w_13[3][10] + n * w_13[3][11]));
}

/* 1024 * 1 --> 1024 * 3 */
static void ntt_butterfly_1024_3072(uint32_t *a, uint32_t n2)
{
	a[N2_3072 + n2] = a[n2];
	a[N2_3072 * 2 + n2] = a[n2];
}

/* 1024 * 2 --> 1024 * 3 */
static void ntt_butterfly_2048_3072(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_3072 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_3072 + n2] = barrett_2q2(b + c * w_3[0]);
	a[N2_3072 * 2 + n2] = barrett_2q2(b + c * w_3[1]);
}

/* 1024 * 3 --> 1024 * 3 */
static void ntt_butterfly_3072_3072_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_3072 + n2];
	d = a[N2_3072 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_3072 + n2] = barrett_4q(b + montgomery(c * w_3_inv[0] + d * w_3_inv[1]));
	a[N2_3072 * 2 + n2] = barrett_4q(b + montgomery(c * w_3_inv[1] + d * w_3_inv[0]));
}

/* 256 * 5 --> 256 * 5 */
static void ntt_butterfly_1280_1280_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f;
	
	b = a[n2];
	c = a[N2_1280 + n2];
	d = a[N2_1280 * 2 + n2];
	e = a[N2_1280 * 3 + n2];
	f = a[N2_1280 * 4 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f);
	a[N2_1280 + n2] = barrett_4q(b + montgomery(c * w_5_inv[0][0] + d * w_5_inv[0][1] + e * w_5_inv[0][2] + f * w_5_inv[0][3]));
	a[N2_1280 * 2 + n2] = barrett_4q(b + montgomery(c * w_5_inv[1][0] + d * w_5_inv[1][1] + e * w_5_inv[1][2] + f * w_5_inv[1][3]));
	a[N2_1280 * 3 + n2] = barrett_4q(b + montgomery(c * w_5_inv[2][0] + d * w_5_inv[2][1] + e * w_5_inv[2][2] + f * w_5_inv[2][3]));
	a[N2_1280 * 4 + n2] = barrett_4q(b + montgomery(c * w_5_inv[3][0] + d * w_5_inv[3][1] + e * w_5_inv[3][2] + f * w_5_inv[3][3]));
}

/* 256 * 4 --> 256 * 5 */
static void ntt_butterfly_1024_1280(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1280 + n2];
	d = a[N2_1280 * 2 + n2];
	e = a[N2_1280 * 3 + n2];
	
	a[n2] = barrett_8q(b + c + d + e);
	a[N2_1280 + n2] = barrett_4q(b + montgomery(c * w_5[0][0] + d * w_5[0][1] + e * w_5[0][2]));
	a[N2_1280 * 2 + n2] = barrett_4q(b + montgomery(c * w_5[1][0] + d * w_5[1][1] + e * w_5[1][2]));
	a[N2_1280 * 3 + n2] = barrett_4q(b + montgomery(c * w_5[2][0] + d * w_5[2][1] + e * w_5[2][2]));
	a[N2_1280 * 4 + n2] = barrett_4q(b + montgomery(c * w_5[3][0] + d * w_5[3][1] + e * w_5[3][2]));
}

/* 256 * 5 --> 256 * 1 */
static void ntt_butterfly_1280_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_16q(a[n2] + a[N2_1280 + n2] + a[N2_1280 * 2 + n2] + a[N2_1280 * 3 + n2] + a[N2_1280 * 4 + n2]);
}

/* 256 * 12 --> 256 * 13 */
static void ntt_butterfly_3072_3328(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k, l, m;
	
	b = a[n2];
	c = a[N2_3328 + n2];
	d = a[N2_3328 * 2 + n2];
	e = a[N2_3328 * 3 + n2];
	f = a[N2_3328 * 4 + n2];
	g = a[N2_3328 * 5 + n2];
	h = a[N2_3328 * 6 + n2];
	i = a[N2_3328 * 7 + n2];
	j = a[N2_3328 * 8 + n2];
	k = a[N2_3328 * 9 + n2];
	l = a[N2_3328 * 10 + n2];
	m = a[N2_3328 * 11 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j + k + l + m);
	a[N2_3328 + n2] = barrett_4q(b + montgomery(c * w_13[0][0] + d * w_13[0][1] + e * w_13[0][2] + f * w_13[0][3] + g * w_13[0][4] + h * w_13[0][5] + i * w_13[0][6] + j * w_13[0][7] + k * w_13[0][8] + l * w_13[0][9] + m * w_13[0][10]));
	a[N2_3328 * 2 + n2] = barrett_4q(b + montgomery(c * w_13[1][0] + d * w_13[1][1] + e * w_13[1][2] + f * w_13[1][3] + g * w_13[1][4] + h * w_13[1][5] + i * w_13[1][6] + j * w_13[1][7] + k * w_13[1][8] + l * w_13[1][9] + m * w_13[1][10]));
	a[N2_3328 * 3 + n2] = barrett_4q(b + montgomery(c * w_13[2][0] + d * w_13[2][1] + e * w_13[2][2] + f * w_13[2][3] + g * w_13[2][4] + h * w_13[2][5] + i * w_13[2][6] + j * w_13[2][7] + k * w_13[2][8] + l * w_13[2][9] + m * w_13[2][10]));
	a[N2_3328 * 4 + n2] = barrett_4q(b + montgomery(c * w_13[3][0] + d * w_13[3][1] + e * w_13[3][2] + f * w_13[3][3] + g * w_13[3][4] + h * w_13[3][5] + i * w_13[3][6] + j * w_13[3][7] + k * w_13[3][8] + l * w_13[3][9] + m * w_13[3][10]));
	a[N2_3328 * 5 + n2] = barrett_4q(b + montgomery(c * w_13[4][0] + d * w_13[4][1] + e * w_13[4][2] + f * w_13[4][3] + g * w_13[4][4] + h * w_13[4][5] + i * w_13[4][6] + j * w_13[4][7] + k * w_13[4][8] + l * w_13[4][9] + m * w_13[4][10]));
	a[N2_3328 * 6 + n2] = barrett_4q(b + montgomery(c * w_13[5][0] + d * w_13[5][1] + e * w_13[5][2] + f * w_13[5][3] + g * w_13[5][4] + h * w_13[5][5] + i * w_13[5][6] + j * w_13[5][7] + k * w_13[5][8] + l * w_13[5][9] + m * w_13[5][10]));
	a[N2_3328 * 7 + n2] = barrett_4q(b + montgomery(c * w_13[6][0] + d * w_13[6][1] + e * w_13[6][2] + f * w_13[6][3] + g * w_13[6][4] + h * w_13[6][5] + i * w_13[6][6] + j * w_13[6][7] + k * w_13[6][8] + l * w_13[6][9] + m * w_13[6][10]));
	a[N2_3328 * 8 + n2] = barrett_4q(b + montgomery(c * w_13[7][0] + d * w_13[7][1] + e * w_13[7][2] + f * w_13[7][3] + g * w_13[7][4] + h * w_13[7][5] + i * w_13[7][6] + j * w_13[7][7] + k * w_13[7][8] + l * w_13[7][9] + m * w_13[7][10]));
	a[N2_3328 * 9 + n2] = barrett_4q(b + montgomery(c * w_13[8][0] + d * w_13[8][1] + e * w_13[8][2] + f * w_13[8][3] + g * w_13[8][4] + h * w_13[8][5] + i * w_13[8][6] + j * w_13[8][7] + k * w_13[8][8] + l * w_13[8][9] + m * w_13[8][10]));
	a[N2_3328 * 10 + n2] = barrett_4q(b + montgomery(c * w_13[9][0] + d * w_13[9][1] + e * w_13[9][2] + f * w_13[9][3] + g * w_13[9][4] + h * w_13[9][5] + i * w_13[9][6] + j * w_13[9][7] + k * w_13[9][8] + l * w_13[9][9] + m * w_13[9][10]));
	a[N2_3328 * 11 + n2] = barrett_4q(b + montgomery(c * w_13[10][0] + d * w_13[10][1] + e * w_13[10][2] + f * w_13[10][3] + g * w_13[10][4] + h * w_13[10][5] + i * w_13[10][6] + j * w_13[10][7] + k * w_13[10][8] + l * w_13[10][9] + m * w_13[10][10]));
	a[N2_3328 * 12 + n2] = barrett_4q(b + montgomery(c * w_13[11][0] + d * w_13[11][1] + e * w_13[11][2] + f * w_13[11][3] + g * w_13[11][4] + h * w_13[11][5] + i * w_13[11][6] + j * w_13[11][7] + k * w_13[11][8] + l * w_13[11][9] + m * w_13[11][10]));
}

/* 256 * 13 --> 256 * 1 */
static void ntt_butterfly_3328_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_32q(a[n2] + a[N2_3328 + n2] + a[N2_3328 * 2 + n2] + a[N2_3328 * 3 + n2] + a[N2_3328 * 4 + n2] + a[N2_3328 * 5 + n2] + a[N2_3328 * 6 + n2] + a[N2_3328 * 7 + n2] + a[N2_3328 * 8 + n2] + a[N2_3328 * 9 + n2] + a[N2_3328 * 10 + n2] + a[N2_3328 * 11 + n2] + a[N2_3328 * 12 + n2]);	
}

void ntt_2048_3328(uint32_t *a)
{
	ntt_core(a, N1_3328, N2_3328, omega_256, omega_3328, ntt_butterfly_2048_3328, bit_reverse_256);
}

void intt_3328_1280(uint32_t *a)
{
	intt_core(a, N1_3328, N2_3328, 1280, omega_256, omega_3328, ntt_butterfly_3328_1280, INV_3328, bit_reverse_256);
}

void ntt_1024_3072(uint32_t *a)
{
	ntt_core(a, N1_3072, N2_3072, omega_1024, omega_3072, ntt_butterfly_1024_3072, bit_reverse_1024);
}

void ntt_2048_3072(uint32_t *a)
{
	ntt_core(a, N1_3072, N2_3072, omega_1024, omega_3072, ntt_butterfly_2048_3072, bit_reverse_1024);
}

void intt_3072_3072_inv(uint32_t *a)
{
	intt_core(a, N1_3072, N2_3072, 3072, omega_1024_inv, omega_3072_inv, ntt_butterfly_3072_3072_inv, INV_3072, bit_reverse_1024);
}

void ntt_1280_1280_inv(uint32_t *a)
{
	ntt_core(a, N1_1280, N2_1280, omega_256_inv, omega_1280_inv, ntt_butterfly_1280_1280_inv, bit_reverse_256);
}

void ntt_1024_1280(uint32_t *a)
{
	ntt_core(a, N1_1280, N2_1280, omega_256, omega_1280, ntt_butterfly_1024_1280, bit_reverse_256);
}

void intt_1280_256(uint32_t *a)
{
	intt_core(a, N1_1280, N2_1280, 256, omega_256, omega_1280, ntt_butterfly_1280_256, INV_1280, bit_reverse_256);
}

void ntt_3072_3328(uint32_t *a)
{
	ntt_core(a, N1_3328, N2_3328, omega_256, omega_3328, ntt_butterfly_3072_3328, bit_reverse_256);
}

void intt_3328_256(uint32_t *a)
{
	intt_core(a, N1_3328, N2_3328, 256, omega_256, omega_3328, ntt_butterfly_3328_256, INV_3328, bit_reverse_256);
}
